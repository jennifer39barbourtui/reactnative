 /**
 * Jeeliz Face Filter - https://github.com/jeeliz/jeelizFaceFilter
 *
 * Copyright 2018 Jeeliz ( https://jeeliz.com )
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/

// BEGIN EMULATE DOM

// import some usefull stuffs
try {
  var Buffer = require('buffer').Buffer;
} catch(err) {
  console.log('Cannot import Buffer package');
}

// emulate global variables:
const navigator = {  
  platform: "Linux x86_64",
  userAgent: "forceWebGL1_noAntialiasing_noDOM"
};

const window = {
  canvas: null,
  innnerWidth: -1,
  innerHeight: -1,
  URL: {
    createObjectURL: function() {
      return null
    }
  },
  addEventListener: function() {},
  removeEventListener: function() {},
  requestAnimationFrame: function(step) {
    if (window.canvas === null){
      setTimeout(step, 1);
      return;
    }
    window.canvas.requestAnimationFrame(step)
  },
  cancelAnimationFrame: function(step) {
    if (window.canvas === null){
      return;
    }
    window.canvas.cancelAnimationFrame(step)
  },
  setCanvas: function(c) {
    window.canvas = c;
  }
};

const document = {
  createElement: function(elementType){
    switch(elementType){
      case 'canvas':
        return null; // return a real canvas
    }
  },
  getElementById: function(elementId){
    return null;
  },
  body: { appendChild: function(element){ return null; }}
};

if(typeof(wx) !== 'undefined'){ //WECHAT
  const systemInfo = wx.getSystemInfoSync()
  window.innnerWidth = systemInfo.windowWidth;
  window.innnerHeight = systemInfo.windowHeight;
}

const FAKEDOM = {
  window: window,
  document: document,
  navigator: navigator
};
// END EMULATE DOM


window.JEELIZFACEFILTERGEN=function(){function Fb(a){var c=null,d=null,e=null,h=0;this.A=function(l){this.df(l.gb);e.fe({ec:l.ec,bc:l.bc})};this.Be=function(l){return c[l]};this.df=function(l){var m=null;h=l.length;c=l.map(function(q,g){q=Object.assign({},q,{index:g,parent:this,nb:m,Le:g===h-1});return m=g=0===g?Gb.instance(q):Hb.instance(q)});d=c[0];e=c[h-1];c.forEach(function(q,g){0!==g&&q.We()})};this.V=function(l){var m=l;c.forEach(function(q){m=q.V(m,!1)});return m};this.Ae=function(){return d.F()};
this.Nb=function(){return e.Ce()};this.Xc=function(){return e.Xc()};this.m=function(){c&&(c.forEach(function(l){l.m()}),e=d=c=null,h=0)};"undefined"!==typeof a&&this.A(a)}function db(a,c){var d=c%8;return a[(c-d)/8]>>7-d&1}function Ib(a){var c=JSON.parse(a);a=c.ne;var d=c.nf,e=c.n;var h="undefined"===typeof btoa?Buffer.from(c.data,"base64").toString("latin1"):atob(c.data);var l=h.length;c=new Uint8Array(l);for(var m=0;m<l;++m)c[m]=h.charCodeAt(m);h=new Float32Array(e);l=new Float32Array(d);m=a+d+
1;for(var q=0;q<e;++q){for(var g=m*q,v=0===db(c,g)?1:-1,B=g+1,r=1,p=0,y=B+a-1;y>=B;--y)p+=r*db(c,y),r*=2;B=p;g=g+1+a;r=l.length;p=0;for(y=g;y<g+r;++y)l[p]=db(c,y,!0),++p;for(r=g=0;r<d;++r)g+=l[r]*Math.pow(2,-r-1);h[q]=0===g&&0===B?0:v*(1+g)*Math.pow(2,1+B-Math.pow(2,a-1))}return h}function Ya(){return-1!==[fa.ready,fa.play,fa.pause].indexOf(na)}function eb(){if(na===fa.play)return!1;na=fa.play;Ma.stop();qb(0)}function rb(){if(na!==fa.play)return!1;Ma.stop();na=fa.pause;return!0}function Fa(a,c,d,
e,h){a=4*(3*c+a)+d;return e+(X.buffer[a]/255+X.buffer[a+12]/65025)*(h-e)}function fb(){b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);ua.da();U.reset();Y.reset();A.R();A.Lc();b.disable(b.DEPTH_TEST);b.disable(b.BLEND);U.Ea();A.xa()}function Jb(){ua.P();b.viewport(0,0,3,2*M.o);A.set("s52");X.za.g(0);U.l(!1,!1);return ba.pb(0,0,3,2*M.o,X.buffer)}function qb(){na!==fa.pause&&(ja.isCleanGLStateAtEachIteration&&(A.Lc(),U.reset(),U.Ea(),b.disable(b.DEPTH_TEST),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),A.xa()),pa.fc(Kb,
Jb,Lb,Mb,ja.animateProcessOrder))}function Kb(){ua.da();if(!z.bb)if(z.ab)z.element.needsUpdate&&(z.N.vf(z.element.arrayBuffer),z.element.needsUpdate=!1);else{var a=z.element.currentTime,c=a-z.ob;0>c&&(z.ob=a);1E3*c<aa.xf||(z.ob+=c,z.N.refresh())}a=pa.Yc();if(M.W.length>a)M.W.splice(0,M.W.length-a);else for(;M.W.length<a;)M.W.push(0);if(1!==M.o)if(qa.every(gb)){for(var d=0,e=c=0;e<qa.length;++e)qa[e].detected>d&&(d=qa[e].detected,c=0);for(d=0;d<a;++d)M.W[d]=c}else{c=M.nd;d=0;for(e=!1;d<a;++d){if(gb(qa[c]))if(e){do++c===
M.o&&(c=0);while(gb(qa[c]))}else e=!0;M.W[d]=c++;c>=M.o&&(c=0)}M.nd=c}for(a=0;a<pa.Yc();++a)M.ma=M.W[a],M.ac=(.5+M.ma)/M.o,M.jd=M.W.lastIndexOf(M.ma)===a,A.set("s54"),c=qa[M.ma],A.H("u41",1+Na.jc*(Math.cos(c.ry)-1)),O.ra&&A.H("u40",c.rz),1!==M.o&&A.H("u39",M.ac),Z.va.aa(),z.N.g(0),X.za.g(1),U.l(!1,!1),Z.va.g(0),Oa.V(Z.va);pa.Kd()}function Lb(){for(var a=0;a<M.o;++a)if(-1!==M.W.indexOf(a)){var c=a,d=Sa[c],e=[c],h=qa[c],l=hb[c],m=2*c;d.Sa=Fa(1,m,3,0,1);h.detected=va.X(h.detected,d.Sa,aa.Qd);if(d.Sa<
aa.pd)O.ra&&(h.rz=0,h.ry=0);else{var q=X.Ka;d.x=Fa(0,m,1,-1,1);d.y=Fa(0,m,2,-1,1);d.$=Fa(0,m,3,0,1);d.hc=Fa(1,m,0,-q[0],q[0]);d.ic=Fa(1,m,1,-q[1],q[1]);d.La=Fa(1,m,2,-q[2],q[2]);for(q=0;q<X.Y;++q)d.Sc[q]=X.Ia[q](Fa(2,m,q,0,1));e.Hb=d.x-h.xRaw;e.Ib=d.y-h.yRaw;e.Gb=d.$-h.sRaw;e.Db=d.hc-h.rx;e.Eb=d.ic-h.ry;e.Fb=O.ra?d.La:d.La-h.rz;m=pa.ve();e=(1-Za.hb(wa.translationFactorRange[0],wa.translationFactorRange[1],Math.sqrt(e.Hb*e.Hb+e.Ib*e.Ib+e.Gb*e.Gb)/m))*(1-Za.hb(wa.rotationFactorRange[0],wa.rotationFactorRange[1],
Math.sqrt(e.Db*e.Db+e.Eb*e.Eb+e.Fb*e.Fb)/m))*Za.hb(wa.qualityFactorRange[0],wa.qualityFactorRange[1],d.Sa);c=l[++ib[c]%l.length]=e;for(m=0;m<l.length;++m)c=Math.min(c,l[m]);c=Math.max(.5,c);e=Math.min(c,e);l=va.X(wa.alphaRange[1],wa.alphaRange[0],Math.pow(e,aa.Sd));h.xRaw=va.X(h.xRaw,d.x,l);h.yRaw=va.X(h.yRaw,d.y,l);h.sRaw=va.X(h.sRaw,d.$,l);h.rx=va.X(h.rx,d.hc,l);h.ry=va.X(h.ry,d.ic,l);h.rz=O.ra?h.rz+l*d.La:va.X(h.rz,d.La,l);c=h.sRaw*Na.Cb*Math.sin(h.ry);e=Math.sin(h.rz)*c/Pa;h.x=h.xRaw+Math.cos(h.rz)*
c;h.y=h.yRaw+e;h.s=h.sRaw;l=Math.max(l,aa.Rd);for(c=0;c<X.Y;++c)h.expressions[c]=va.X(h.expressions[c],d.Sc[c],l);++d.kb}}ua.tf();ja.isCleanGLStateAtEachIteration&&(ua.reset(),Y.reset(),b.enable(b.DEPTH_TEST));O.Ra&&(1===M.o?O.Ra(qa[0]):O.Ra(qa));ja.isCleanGLStateAtEachIteration&&b.disable(b.BLEND)}function Mb(){na===fa.play&&Ma.fc(qb)}function sb(){Z.va=Y.instance({isPot:!0,isFloat:!1,width:Oa.Ae()});for(var a=aa.Hd,c=M.o,d=new Float32Array([0,.5,.5,0,0,0,0,0,0,0,0,0]),e=new Float32Array(d.length*
M.o),h=0,l;h<M.o;++h)for(l=0;l<d.length;++l)e[h*d.length+l]=d[l];X.za=Nb.instance({width:a,height:c,isFloat:!0,isPot:!1,array:e})}function Ob(){function a(c){for(var d=[],e=0;e<M.o;++e)d.push(JSON.parse(JSON.stringify(c)));return d}X.buffer=new Uint8Array(8*aa.Hd*M.o);Sa=a({Sa:0,x:0,y:0,$:1,hc:0,ic:0,La:0,Sc:new Float32Array(X.Y),kb:0});qa=a({detected:0,x:0,y:0,s:1,xRaw:0,yRaw:0,sRaw:1,rx:0,ry:0,rz:0,expressions:new Float32Array(X.Y)});a({Hb:0,Ib:0,Gb:0,Db:0,Eb:0,Fb:0})}function jb(){A.T("s54",[{type:"1i",
name:"u1",value:0},{type:"1i",name:"u37",value:1},{type:"2f",name:"u38",value:Z.G},{type:"1f",name:"u39",value:.5},{type:"1f",name:"u40",value:0}]);A.T("s55",[{type:"1i",name:"u42",value:0},{type:"1i",name:"u37",value:1},{type:"1f",name:"u45",value:aa.rf},{type:"1f",name:"u46",value:ja.threshold},{type:"3f",name:"u44",value:[X.O[0]*Z.G[0],X.O[1]*Z.G[1],X.O[2]]},{type:"1f",name:"u39",value:.5},{type:"1f",name:"u47",value:1},{type:"1f",name:"u40",value:0}]);var a=[{type:"1i",name:"u42",value:0}];A.T("s56",
a);A.T("s57",a);A.T("s52",[{type:"1i",name:"u37",value:0},{type:"1f",name:"u50",value:Z.G[0]},{type:"2f",name:"u49",value:[0,.5/M.o]}])}function kb(){Z.G[0]=1;Z.G[1]=Z.D/Z.M;tb.A({mb:ja.overlapFactors,td:ja.nScaleLevels,D:Z.D,M:Z.M,Cd:ja.scale0Factor,O:X.O,Dd:ja.scanCenterFirst})}function Pb(a){if(O.Aa)ub("string"===typeof O.Aa?JSON.parse(O.Aa):O.Aa,a);else{var c=O.wc;"JSON"!==c.toUpperCase().split(".").pop()&&(c+=aa.neuralNetworkPath);vb.get(c,function(d){d=JSON.parse(d);ub(d,a)})}}function ub(a,
c){if(a.exportData){var d=a.exportData;d.rotationEulerAnglesFactors&&(X.Ka=d.rotationEulerAnglesFactors);d.translationScalingFactors&&(X.O=d.translationScalingFactors);"undefined"!==typeof d.nExpressions&&(X.Y=d.nExpressions);Na.jc=.4;Na.Cb=.7;"undefined"!==typeof d.fgScaleXFactor&&(Na.jc=d.fgScaleXFactor);"undefined"!==typeof d.fgDisplaceXFactor&&(Na.Cb=d.fgDisplaceXFactor)}X.Y||(X.Y=aa.sd);if(!X.Ia)for(X.Ia=[],d=0;d<X.Y;++d)X.Ia.push(aa.pe);c(a)}function Qb(){if(Qa.A({zb:O.ea,width:Z.D,height:Z.M,
debug:!1,ud:function(){Ha("GLCONTEXT_LOST")},antialias:O.antialias,premultipliedAlpha:!0}))return!0;Ha("GL_INCOMPATIBLE");return!1}function gb(a){return a.detected<=aa.pd}function wb(a,c,d,e){return d>a?Math.max(0,a+c/2-(d-e/2)):Math.max(0,d+e/2-(a-c/2))}function Rb(){return Sa.some(function(a,c){if(c===M.ma)return!1;c=Sa[M.ma];if(c.kb>a.kb||3>a.kb||wb(c.x,c.$,a.x,a.$)<aa.qd*c.$)return!1;var d=Z.D/Z.M;return wb(c.y,c.$*d,a.y,a.$*d)>aa.qd*c.$*d})}function Sb(){var a=M.ma;X.za.cf(1);1!==M.o&&(b.viewport(0,
0,3,M.o),A.set("s0"),A.Gd("u1",1),U.l(!1,!1),A.Gd("u1",0));b.viewport(0,a,1,1);A.set("s55");O.ra&&A.H("u40",qa[a].rz);1!==M.o&&A.H("u39",M.ac);if(1<M.o){var c=Rb()?0:1;A.H("u47",c)}A.hf("u43",tb.get());U.l(!1,!1);M.jd&&(b.viewport(1,a,1,1),A.set("s56"),U.l(!1,!1),b.viewport(2,a,1,1),A.set("s57"),U.l(!1,!1))}function xb(){z.N&&z.N.remove();z.ab=z.element.isFakeVideo?!0:!1;if(z.ab){var a=yb();a={isFlipY:!1,array:z.element.arrayBuffer,width:a.w,height:a.ua,isKeepArray:!0}}else a={I:z.element};z.oc=Y.instance(Object.assign({isPot:!1,
isLinear:!0,isFloat:!1},a));z.N=z.oc}function Ia(){var a=[{type:"mat2",name:"u36",value:z.v}];A.T("s53",[{type:"1i",name:"u1",value:0}].concat(a));A.T("s54",a)}function Ja(){z.L[0]=.5;z.L[1]=.5;var a=z.G[1]/z.G[0];Pa=Qa.U()/Qa.F();90===Math.abs(oa.rotate)&&(a=1/a);a>Pa?z.L[1]*=Pa/a:z.L[0]*=a/Pa;A.T("s55",[{name:"u48",type:"1f",value:Pa}]);z.v[0]=0;z.v[1]=0;z.v[2]=0;z.v[3]=0;switch(oa.rotate){case 0:z.v[0]=z.L[0];z.v[3]=z.L[1];break;case 180:z.v[0]=-z.L[0];z.v[3]=-z.L[1];break;case 90:z.v[1]=z.L[0];
z.v[2]=-z.L[1];break;case -90:z.v[1]=-z.L[0],z.v[2]=z.L[1]}oa.flipX&&(z.v[0]*=-1,z.v[2]*=-1);z.bb||(z.v[1]*=-1,z.v[3]*=-1)}function yb(){var a={w:z.element.videoWidth||z.element.width,ua:z.element.videoHeight||z.element.height};if(!a.w||!a.ua||4>a.w||4>a.ua)throw Error("INVALID VIDEO DIMENSIONS - width = "+a.w+" height = "+a.ua);return a}function lb(){var a=yb(),c=z.G[0]!==a.w||z.G[1]!==a.ua;c&&(z.G[0]=a.w,z.G[1]=a.ua);return c}function $a(a,c){if(na===fa.error)return!1;z.element=a;lb();c&&c();return!0}
function zb(a,c,d){a&&a();z.Ga={video:{facingMode:{exact:oa.facingMode},width:{min:oa.minWidth,max:oa.maxWidth,ideal:oa.idealWidth},height:{min:oa.minHeight,max:oa.maxHeight,ideal:oa.idealHeight}},audio:!1};W.yc(z.Ga,oa.deviceId);W.get(z.element?z.element:W.Ee(),function(e){c&&c(e);d(e)},function(){Ha("WEBCAM_UNAVAILABLE")},z.Ga)}function Ha(a){na!==fa.error&&(na=fa.error,O.Fa&&O.Fa(a))}var va={sg:function(a){return Math.ceil(Math.log2(a))},Lg:function(a){return Math.log2(a)},Hg:function(a){return 0===
Math.log2(a)%1},Hf:function(a){var c=[0,0,0,0];a.forEach(function(d){c[0]+=d[0];c[1]+=d[1];c[2]+=d[2];c[3]+=d[3]});return c},If:function(a,c,d){return Math.min(Math.max(a,c),d)},Lf:function(a){return a*Math.PI/180},Qg:function(a,c){c=Math.pow(10,c);return Math.round(a*c)/c},Rg:function(a){return Math.round(1E6*a)/1E6},tg:function(a,c){return(100*a/c).toFixed(3)},X:function(a,c,d){return a*(1-d)+c*d},ke:function(a,c){return va.ce(a-c)},ce:function(a){for(;a>Math.PI;)a-=2*Math.PI;for(;a<=-Math.PI;)a+=
2*Math.PI;return a},Of:function(a,c){return Math.abs(va.ke(a,c))},yf:function(a,c){return Math.atan2(Math.sin(a)+Math.sin(c),Math.cos(a)+Math.cos(c))}},vb={get:function(a,c,d){var e=new XMLHttpRequest;e.open("GET",a,!0);e.withCredentials=!1;e.onreadystatechange=function(){4===e.readyState&&(200===e.status||0===e.status?c(e.responseText):"undefined"!==typeof d&&d(e.status))};e.send()},pg:function(a,c){vb.get(a,function(d){c(JSON.parse(d))})},Ng:function(a,c,d){var e=new XMLHttpRequest;e.open("POST",
a,!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.onreadystatechange=function(){4!==e.readyState||200!==e.status&&0!==e.status||d(e.responseText)};e.send(c)},eg:function(a,c){var d=new XMLHttpRequest;d.open("POST",a,!0);d.responseType="arraybuffer";d.onload=function(){c(d.response)};d.send()}},Tb={create:function(a,c){for(var d=Array(c),e=0;e<c;++e)d[e]=a;return d},Mf:function(a,c){for(var d=0;d<a.length;++d)c[d]=a[d]},clone:function(a){for(var c=Array(a.length),d=0;d<
a.length;++d)c[d]=a[d];return c},Ug:function(a,c,d){a.forEach(function(e,h){c[h]=e*d})},eh:function(a){for(var c=a.length-1;0<c;--c){var d=Math.floor(Math.random()*(c+1)),e=a[c];a[c]=a[d];a[d]=e}},qf:function(a){return Array.isArray(a)||a.constructor===Float32Array||a.constructor===Uint8Array}},mb={Ab:function(a,c){if(0===c||"object"!==typeof a)return a;a=Object.assign({},a);c=void 0===c||-1===c?-1:c-1;for(var d in a)a[d]=mb.Ab(a[d],c);return a}},Za={fh:function(a,c,d){a=Math.min(Math.max((d-a)/(c-
a),0),1);return a*a*(3-2*a)},hb:function(a,c,d){return Math.min(Math.max((d-a)/(c-a),0),1)},Zf:function(a,c,d,e){return Math.pow(Math.min(Math.max((e-a)/(c-a),0),1),d)},jh:function(){return 0},Mg:function(){return 1},Kg:function(a){return a},Wf:function(a){return a*a},ag:function(a){return a*(2-a)},Tf:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},Rf:function(a){return a*a*a},$f:function(a){return--a*a*a+1},Sf:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},Xf:function(a){return a*a*a*a},bg:function(a){return 1-
--a*a*a*a},Uf:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},Yf:function(a){return a*a*a*a*a},cg:function(a){return 1+--a*a*a*a*a},Vf:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}},Ub={re:function(a,c,d){switch(a){case "relu":return d+"=max(vec4(0.,0.,0.,0.),"+c+");";case "elu":return d+"=mix(exp(-abs("+c+"))-vec4(1.,1.,1.,1.),"+c+",step(0.,"+c+"));";case "elu01":return d+"=mix(0.1*exp(-abs("+c+"))-vec4(0.1,0.1,0.1,0.1),"+c+",step(0.,"+c+"));";case "arctan":return d+"=atan(3.14159265359*texture2D(u0,vUV))/3.14159265359;";
case "copy":return"";default:return!1}}},A=function(){function a(u,t,D){t=u.createShader(t);u.shaderSource(t,D);u.compileShader(t);return u.getShaderParameter(t,u.COMPILE_STATUS)?t:!1}function c(u,t,D){t=a(u,u.VERTEX_SHADER,t);D=a(u,u.FRAGMENT_SHADER,D);u===b&&m.push(t,D);var K=u.createProgram();u.attachShader(K,t);u.attachShader(K,D);u.linkProgram(K);return K}function d(u,t){t.C=t.C?!0:!1;if(!t.C){void 0===t.qa&&(t.qa="precision lowp float;attribute vec2 a0;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=a0*.5+vec2(.5,.5);}");
void 0===t.Pa&&(t.Pa=["a0"]);void 0===t.Ca&&(t.Ca=[2]);if(void 0===t.precision||"highp"===t.precision)t.precision=r;t.id=v++;void 0!==t.Ed&&(t.Ed.forEach(function(K,P){t.h=t.h.replace(K,t.qb[P])}),t.Ed.splice(0));t.vc=0;t.Ca.forEach(function(K){t.vc+=4*K});t.oa=c(u,t.qa,"precision "+t.precision+" float;\n"+t.h);t.B={};t.i.forEach(function(K){t.B[K]=u.getUniformLocation(t.oa,K)});t.attributes={};t.Da=[];t.Pa.forEach(function(K){var P=u.getAttribLocation(t.oa,K);t.attributes[K]=P;t.Da.push(P)});if(t.j){u.useProgram(t.oa);
g=t;q=t.id;for(var D in t.j)u.uniform1i(t.B[D],t.j[D])}t.na=!0}}function e(u){xa.gf(J);q!==u.id&&(J.R(),q=u.id,g=u,b.useProgram(u.oa),u.Da.forEach(function(t){0!==t&&b.enableVertexAttribArray(t)}))}function h(u,t,D){d(u,t,D);u.useProgram(t.oa);u.enableVertexAttribArray(0);q=-1;return g=t}function l(){return{h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",i:["u1"],j:{u1:0}}}var m=[],q=-1,g=null,v=0,B=!1,r="highp",p=["u1"],y=["u0"],w={u1:0},f={u0:0},n={u1:0,u2:1},
F={u3:0},L={s0:l(),s1:{h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",i:p,j:w,precision:"lowp"},s2:{h:"uniform sampler2D u1,u2;varying vec2 vv0;void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a*b;}",i:["u1","u2"],j:n},s3:{h:"uniform sampler2D u1;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a.r*f;}",i:p,j:w},s4:{h:"uniform sampler2D u1,u2;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a.a*b.r*f;}",
i:["u1","u2"],j:n},s5:{h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(1.-vv0.x,vv0.y));}",i:p,j:w},s6:{h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(vv0.x,1.-vv0.y));}",i:p,j:w},s7:{h:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=a*u4;}",i:["u0","u4"],j:f},s8:{h:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;const vec4 f=vec4(.25,.25,.25,.25),g=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);float b=dot(a*u4,f);gl_FragColor=b*g;}",
i:["u0","u4"],j:f},s9:{h:"uniform sampler2D u1;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){float a=.25*dot(e,texture2D(u1,vv0));gl_FragColor=a*e;}",i:p,j:w},s10:{h:"uniform sampler2D u1,u5;uniform float u6;const vec4 f=vec4(1.,1.,1.,1.);varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0),b=texture2D(u5,vv0);gl_FragColor=mix(b,a,u6*f);}",i:["u1","u5","u6"],j:{u1:0,u5:1}},s11:{h:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;void main(){gl_FragColor=.25*(texture2D(u1,vv0+u7)+texture2D(u1,vv0+u7*vec2(1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,1.)));}",
i:["u1","u7"],j:w},s12:{h:"uniform sampler2D u1;uniform vec4 u8;varying vec2 vv0;float g(float a,float b){a=floor(a)+.5;return floor(a/exp2(b));}float h(float a,float b){return floor(a*exp2(b)+.5);}float i(float a,float b){return mod(a,h(1.,b));}float e(float c,float a,float b){a=floor(a+.5),b=floor(b+.5);return i(g(c,a),b-a);}vec4 j(float a){if(a==0.)return vec4(0.,0.,0.,0.);float k=128.*step(a,0.);a=abs(a);float c=floor(log2(a)),l=c+127.,b=(a/exp2(c)-1.)*8388608.,d=l/2.,m=fract(d)*2.,n=floor(d),o=e(b,0.,8.),p=e(b,8.,16.),q=m*128.+e(b,16.,23.),r=k+n;return vec4(o,p,q,r)/255.;}void main(){float a=dot(texture2D(u1,vv0),u8);gl_FragColor=j(a);}",
i:["u1","u8"],j:w},s13:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=e/(e+exp(-a));gl_FragColor=b;}",i:y,j:f,C:!0},s14:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(0.,0.,0.,0.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=max(f,a);}",i:y,j:f},s15:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=mix(exp(-abs(a))-f,a,step(0.,a));}",i:y,j:f},
s16:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=exp(-abs(a))-f;gl_FragColor=mix(.1*b,a,step(0.,a));}",i:y,j:f},s17:{h:"uniform sampler2D u0,u6,u9;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),c=texture2D(u6,vv0),d=texture2D(u9,vv0),b=a/d;gl_FragColor=c*mix(exp(-abs(b))-f,b,step(0.,a));}",i:["u0","u6","u9"],j:{u0:0,u6:1,u9:2},C:!0},s18:{h:"uniform sampler2D u0;const float e=3.141593;varying vec2 vv0;void main(){gl_FragColor=atan(e*texture2D(u0,vv0))/e;}",
i:y,j:f},s19:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=log(f+a);gl_FragColor=b;}",i:y,j:f,C:!0},s20:{h:"uniform sampler2D u0,u10;uniform float u11;const vec2 e=vec2(.5,.5);const float f=1e-5;const vec4 g=vec4(1.,1.,1.,1.),i=vec4(0.,0.,0.,0.);varying vec2 vv0;void main(){vec4 a=texture2D(u10,e);float b=u11*u11;vec4 c=max(b*a,f*g);gl_FragColor=texture2D(u0,vv0)/c;}",i:["u0","u10","u11"],j:{u0:0,u10:1},C:!0},s21:{h:"uniform sampler2D u1;uniform vec2 u12;varying vec2 vv0;void main(){float a=u12.x*u12.y;vec2 b=floor(vv0*a)/a,c=fract(vv0*a),d=floor(b*u12.y),f=floor(u12.x*fract(b*u12.y)),g=(f*u12.y+d)/a;gl_FragColor=texture2D(u1,g+c/a);}",
i:["u1","u12"],j:w},s22:{h:"uniform sampler2D u13,u14,u15;varying vec2 vv0;void main(){vec4 a=texture2D(u15,vv0);vec2 b=a.rg,c=a.ba;vec4 d=texture2D(u13,b),f=texture2D(u14,c);gl_FragColor=d*f;}",i:["u13","u14","u15"],j:{u14:0,u13:1,u15:2},C:!0},s23:{h:"uniform float u16;uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec2 a=fract(vv0*u16);vec4 b=texture2D(u13,vv0),c=texture2D(u14,a);gl_FragColor=b*c;}",i:["u14","u13","u16"],j:{u14:0,u13:1}},s24:{h:"uniform float u16;uniform sampler2D u13,u14,u17,u18,u19,u20;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.),g=vec4(1e-3,1e-3,1e-3,1e-3);void main(){vec2 h=vv0*u16,l=floor(h),c=h-l;vec4 m=texture2D(u13,vv0),d=texture2D(u14,c),a=texture2D(u20,vv0);a=a*255.;vec4 n=texture2D(u17,c),o=texture2D(u18,c),p=texture2D(u19,c),i=step(-g,-a),b=e-i,j=b*step(-e-g,-a);b*=e-j;vec4 k=b*step(-2.*e-g,-a);b*=e-k;vec4 q=b;d=i*d+j*n+k*o+q*p,gl_FragColor=m*d;}",
i:"u13 u14 u16 u20 u17 u18 u19".split(" "),j:{u14:0,u13:1,u20:3,u17:4,u18:5,u19:6},C:!0},s25:{h:"uniform sampler2D u13,u14,u21;uniform float u16,u22,u23,u24;varying vec2 vv0;const vec2 j=vec2(1.,1.);void main(){vec2 a=floor(u22*vv0),b=u22*vv0-a;float c=u16/u22;vec2 d=floor(b*c),f=b*c-d,g=(a+f)/u22;float k=u22*u24/u16;vec2 l=k*d,h=(l+f*u23)/u24,i=step(h,j);vec4 m=texture2D(u13,g),n=texture2D(u14,h),o=m*n*i.x*i.y,p=texture2D(u21,g);gl_FragColor=o*u23*u23+p;}",i:"u13 u14 u16 u22 u23 u24 u21".split(" "),
j:{u14:0,u13:1,u21:2}},s26:{h:"uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec4 a=texture2D(u13,vv0),b=texture2D(u14,vv0);gl_FragColor=a*b;}",i:["u13","u14"],j:{u14:0,u13:1},C:!0},s27:{h:"uniform sampler2D u1,u21;uniform float u25;varying vec2 vv0;void main(){gl_FragColor=texture2D(u21,vv0)+u25*texture2D(u1,vv0);}",i:["u1","u21","u25"],j:{u1:0,u21:1}},s28:{h:"varying vec2 vv0;uniform sampler2D u1;const vec4 f=vec4(1.,1.,1.,1.),g=vec4(.299,.587,.114,0.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=dot(a,g)*f;}",
i:p,j:w,precision:"lowp"},s29:{h:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(dot(a,f),dot(b,f),dot(c,f),dot(d,f));}",i:["u1","u26"],j:w,precision:"lowp"},s30:{h:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(a.r,b.g,c.b,dot(d,f));}",
i:["u1","u26"],j:w,precision:"lowp"},s31:{h:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=vec4(0.);a-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y))*2.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y))*2.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec4 b=vec4(0.);b-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,b-=texture2D(u1,vec2(vv0.x,vv0.y-u27))*2.,b-=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,b+=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,b+=texture2D(u1,vec2(vv0.x,vv0.y+u27))*2.,b+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec3 c=sqrt(a.rgb*a.rgb+b.rgb*b.rgb);vec4 e=vec4(c,texture2D(u1,vv0).a),g=texture2D(u2,vv0);gl_FragColor=g.a*e.r*f;}",
i:["u1","u2","u27"],j:n,C:!0},s32:{h:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 j=vec4(1.,1.,1.,1.);const vec2 k=vec2(1.,1.);void main(){float h=0.;vec2 l=k*u27,a,b;float c,d,i=0.;for(float e=-4.;e<=4.;e+=1.)for(float f=-4.;f<=4.;f+=1.)a=vec2(e,f),c=length(a)/2.,d=exp(-c*c),b=vv0+l*a,h+=d*texture2D(u1,b).r,i+=d;vec4 m=texture2D(u2,vv0);gl_FragColor=m.a*(texture2D(u1,b).r-h/i)*j;}",i:["u1","u2","u27"],j:n,C:!0},s33:{h:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}const vec2 g=vec2(.5,.5),h=vec2(1.,0.),i=vec2(0.,1.);void main(){vec2 a=vv0-u7*g;vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*h),d=texture2D(u3,a+u7*i),j=texture2D(u3,a+u7),k=e(b,c),l=e(d,j);gl_FragColor=e(k,l);}",
i:["u3","u7"],j:F},s34:{h:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;const vec2 k=vec2(1.,0.),l=vec2(0.,1.),m=vec2(2.,0.),n=vec2(0.,2.);vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}vec4 f(vec2 a){vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*k),d=texture2D(u3,a+u7*l),g=texture2D(u3,a+u7),h=e(b,c),i=e(d,g);return e(h,i);}void main(){vec2 a=vv0+u7*vec2(-.55,-1.05);vec4 b=f(a),c=f(a+u7*m),d=f(a+u7*2.),g=f(a+u7*n),h=e(b,c),i=e(d,g);gl_FragColor=e(h,i);}",i:["u3","u7"],j:F,C:!0},
s35:{h:"uniform sampler2D u1;varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a*a;}",i:["u1"],j:w,precision:"lowp",C:!0},s36:{h:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const float e=15444.;void main(){vec4 a=1001./e*texture2D(u1,vv0-3.*u7)+2002./e*texture2D(u1,vv0-2.*u7)+3003./e*texture2D(u1,vv0-u7)+3432./e*texture2D(u1,vv0)+3003./e*texture2D(u1,vv0+u7)+2002./e*texture2D(u1,vv0+2.*u7)+1001./e*texture2D(u1,vv0+3.*u7);gl_FragColor=a;}",i:["u7","u1"],j:w,precision:"lowp",
C:!0},s37:{h:"uniform sampler2D u1,u10,u28;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);const float g=.1;void main(){vec4 a=texture2D(u10,vv0),b=texture2D(u28,vv0),c=texture2D(u1,vv0),d=max(f*g,b-a*a),h=sqrt(d);gl_FragColor=(c-a)/h;}",i:["u1","u10","u28"],j:{u1:0,u10:1,u28:2},C:!0}},E={s38:{h:"uniform float u16,u29;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-5,1e-5);void main(){vec4 sum=texture2D(u21,vv0);float toSparsity=1.1111;vec2 uvFrom,uvWeight,xyPatch=ZERO2,eps2=EPS2/u16,xyTo=floor(vv0*u16+eps2);float weightSize=toSparsity*u16;vec2 halfFromSparsity=ONE2*(toSparsity-1.)/2.;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.)xyPatch.y=patch_y,uvFrom=(xyTo+HALF2+u29*(xyPatch-halfFromSparsity))/u16,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),uvWeight=(xyTo*toSparsity+xyPatch+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}gl_FragColor=sum,gl_FragColor*=2.2222;}",
i:["u16","u13","u14","u21","u29"],qb:["1.1111","gl_FragColor\\*=2.2222;"]},s39:{h:"uniform float u16,u29,u24;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-4,1e-4);void main(){vec4 sum=texture2D(u21,vv0);float fromSparsity=1.1111,shrinkFactor=3.3333;vec2 uvFrom,uvWeight,xyFrom,xyPatchTo,xyPatch=ZERO2,xyShrink=ZERO2,eps2=EPS2/u24,xyTo=floor(vv0*u16+eps2);float weightSize=fromSparsity*u24;vec2 halfFromSparsity=ONE2*(fromSparsity-1.)/2.;float toSparsity=weightSize/u16;vec2 xyFrom0=xyTo*shrinkFactor;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.){xyPatch.y=patch_y;for(float shrink_x=0.;shrink_x<3.3333;shrink_x+=1.){xyShrink.x=shrink_x;for(float shrink_y=0.;shrink_y<3.3333;shrink_y+=1.)xyShrink.y=shrink_y,xyFrom=xyFrom0+xyShrink+shrinkFactor*u29*(xyPatch-halfFromSparsity),uvFrom=(xyFrom+HALF2)/u24,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),xyPatchTo=xyPatch*shrinkFactor+xyShrink,uvWeight=(xyTo*toSparsity+xyPatchTo+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}}}gl_FragColor=sum,gl_FragColor*=2.2222;}",
i:"u16 u24 u13 u14 u21 u29".split(" "),qb:["1.1111","gl_FragColor\\*=2.2222;","3.3333"]}},Q=null,G=null,J={fb:function(){return B},A:function(){if(!B){Q=mb.Ab(L,2);G=mb.Ab(E,2);r="highp";for(var u in Q)d(b,Q[u],u);A.set("s0");b.enableVertexAttribArray(0);B=!0}},Ac:function(u){u.forEach(function(t){J.zc(t)})},zc:function(u){Q[u.id]=u;d(b,u,u.id)},ad:function(u,t,D){t||(t=u);Q[t]=Object.create(G[u]);Q[t].Ke=!0;G[u].qb&&G[u].qb.forEach(function(K,P){Q[t].h=Q[t].h.replace(new RegExp(K,"g"),D[P])});d(b,
Q[t],t)},set:function(u){var t=Q[u];t.C&&(t.C=!1,d(b,t,u));e(t)},Ma:function(u){return h(u,l(),"s40")},lc:function(u){return h(u,{h:"void main(){gl_FragColor=vec4(.5,.5,.5,.5);}",i:[],precision:"highp"},"s41")},oe:function(u){return"undefined"===typeof Q[u]?!1:Q[u].na},R:function(){-1!==q&&(q=-1,g.Da.forEach(function(u){0!==u&&b.disableVertexAttribArray(u)}))},nc:function(){var u=0;g.Da.forEach(function(t,D){D=g.Ca[D];b.vertexAttribPointer(t,D,b.FLOAT,!1,g.vc,u);u+=4*D})},Lc:function(){b.enableVertexAttribArray(0)},
xa:function(){J.rb(b)},rb:function(u){u.vertexAttribPointer(g.Da[0],2,u.FLOAT,!1,8,0)},Gd:function(u,t){b.uniform1i(g.B[u],t)},H:function(u,t){b.uniform1f(g.B[u],t)},pa:function(u,t,D){b.uniform2f(g.B[u],t,D)},Yg:function(u,t){b.uniform2fv(g.B[u],t)},hf:function(u,t){b.uniform3fv(g.B[u],t)},Zg:function(u,t,D,K){b.uniform3f(g.B[u],t,D,K)},$g:function(u,t,D,K,P){b.uniform4f(g.B[u],t,D,K,P)},mc:function(u,t){b.uniform4fv(g.B[u],t)},ah:function(u,t){b.uniformMatrix2fv(g.B[u],!1,t)},bh:function(u,t){b.uniformMatrix3fv(g.B[u],
!1,t)},dh:function(u,t){b.uniformMatrix4fv(g.B[u],!1,t)},T:function(u,t){J.set(u);t.forEach(function(D){switch(D.type){case "4f":b.uniform4fv(g.B[D.name],D.value);break;case "3f":b.uniform3fv(g.B[D.name],D.value);break;case "2f":b.uniform2fv(g.B[D.name],D.value);break;case "1f":b.uniform1f(g.B[D.name],D.value);break;case "1i":b.uniform1i(g.B[D.name],D.value);break;case "mat2":b.uniformMatrix2fv(g.B[D.name],!1,D.value);break;case "mat3":b.uniformMatrix3fv(g.B[D.name],!1,D.value);break;case "mat4":b.uniformMatrix4fv(g.B[D.name],
!1,D.value)}})},rg:function(){return"lowp"},m:function(){b.disableVertexAttribArray(0);J.R();for(var u in Q){var t=Q[u];t.na&&(t.na=!1,b.deleteProgram(t.oa));t.Ke&&delete Q[u]}m.forEach(function(D){b.deleteShader(D)});m.splice(0);v=0;B=!1;g=null;q=-1}};return J}(),b=null,Qa=function(){function a(r){console.log("ERROR in ContextFF: ",r);return!1}function c(r){function p(){Ca.m();ba.reset();w.getExtension("WEBGL_lose_context").loseContext()}if(navigator.userAgent&&-1!==navigator.userAgent.indexOf("forceWebGL1"))return!1;
var y=document.createElement("canvas");y.setAttribute("width",5);y.setAttribute("height",5);var w=null;try{w=y.getContext("webgl2",r)}catch(f){return!1}if(!w)return!1;d(w);ba.Mc(w);r=ba.Bb(w);if(!r.fa&&!r.ga)return p(),!1;r=Ca.Dc(w,r);p();return r?!0:!1}function d(r){r.clearColor(0,0,0,0);r.disable(r.DEPTH_TEST);r.disable(r.BLEND);r.disable(r.DITHER);r.disable(r.STENCIL_TEST);r.disable(r.CULL_FACE);r.GENERATE_MIPMAP_HINT&&r.hint(r.GENERATE_MIPMAP_HINT,r.FASTEST);r.disable(r.SAMPLE_ALPHA_TO_COVERAGE);
r.disable(r.SAMPLE_COVERAGE);r.depthFunc(r.LEQUAL);r.clearDepth(1)}var e=null,h=null,l=null,m=null,q=!0,g=null,v=null,B={F:function(){return e.width},U:function(){return e.height},ig:function(){return e},gg:function(){return b},ia:function(){return q},flush:function(){b.flush()},ue:function(){g||(g=new Uint8Array(e.width*e.height*4));b.readPixels(0,0,e.width,e.height,b.RGBA,b.UNSIGNED_BYTE,g);return g},kg:function(){return e.toDataURL("image/jpeg")},lg:function(){ua.P();h||(h=document.createElement("canvas"),
l=h.getContext("2d"));h.width=e.width;h.height=e.height;for(var r=B.ue(),p=l.createImageData(h.width,h.height),y=h.width,w=h.height,f=p.data,n=0;n<w;++n)for(var F=w-n-1,L=0;L<y;++L){var E=4*(n*y+L),Q=4*(F*y+L);f[E]=r[Q];f[E+1]=r[Q+1];f[E+2]=r[Q+2];f[E+3]=r[Q+3]}l.putImageData(p,0,0);return h.toDataURL("image/png")},jg:function(r){!h&&r&&(h=document.createElement("canvas"),l=h.getContext("2d"));var p=r?h:document.createElement("canvas");p.width=e.width;p.height=e.height;(r?l:p.getContext("2d")).drawImage(e,
0,0);return p},A:function(r){r.ge&&!r.zb?e=document.getElementById(r.ge):r.zb&&(e=r.zb);e||(e=document.createElement("canvas"));e.width=r&&void 0!==r.width?r.width:512;e.height=r&&void 0!==r.height?r.height:512;"undefined"===typeof r&&(r={});void 0===r.premultipliedAlpha&&(r.premultipliedAlpha=!1);void 0===r.ed&&(r.ed=!0);void 0===r.antialias&&(r.antialias=!1);if(b)q=b instanceof WebGL2RenderingContext;else{q=!0;var p={antialias:r.antialias,alpha:!0,preserveDrawingBuffer:!0,premultipliedAlpha:r.premultipliedAlpha,
stencil:!1,depth:r.ed};navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("noAntialiasing")&&(p.antialias=!1);var y=c(p);!y&&p.antialias&&(p.antialias=!1,y=c(p));y&&(b=e.getContext("webgl2",p));b?q=!0:((b=e.getContext("webgl",p))||(b=e.getContext("experimental-webgl",p)),q=!1)}if(!b)return a("WebGL1 and 2 are not enabled");(m=b.getExtension("WEBGL_lose_context"))&&r.ud&&(v=r.ud,e.addEventListener("webglcontextlost",v,!1));if(!ba.A())return a("Not enough GL capabilities");d(b);A.A();
U.A();return Ca.Dc(b,ba.te())?!0:a("Cannot filter float textures")},m:function(){b&&(ba.m(),Ca.m());m&&v&&(e.removeEventListener("webglcontextlost",v,!1),m=v=null);b=g=l=h=e=null}};return B}(),xa=function(){function a(){null===c&&("undefined"!==typeof A?c=A:"undefined"!==typeof JEShaders&&(c=JEShaders))}var c=null;a();return{gf:function(d){c!==d&&(c&&c.R(),c=d)},fb:function(){return c.fb()},xa:function(){return c.xa()},rb:function(d){return c.rb(d)},nc:function(){return c.nc()},R:function(){return c.R()},
set:function(d){return c.set(d)},Ma:function(d){a();return c.Ma(d)},lc:function(d){a();return c.lc(d)},m:function(){return c.m()}}}(),Ba=function(){function a(k){b.bindTexture(b.TEXTURE_2D,k)}function c(k){t[0]=k;k=D[0];var I=k>>16&32768,H=k>>12&2047,N=k>>23&255;return 103>N?I:142<N?I|31744|((255==N?0:1)&&k&8388607):113>N?(H|=2048,I|(H>>114-N)+(H>>113-N&1)):I=(I|N-112<<10|H>>1)+(H&1)}function d(k){var I=new Uint16Array(k.length);k.forEach(function(H,N){I[N]=c(H)});return I}function e(){if(null!==
K.Qb)return K.Qb;var k=l(d([.5,.5,.5,.5]));return null===k?!0:K.Qb=k}function h(){if(null!==K.Rb)return K.Rb;var k=l(new Uint8Array([127,127,127,127]));return null===k?!0:K.Rb=k}function l(k){if(!xa.fb()||!f)return null;var I=null,H=Math.sqrt(k.length/4);try{var N=b.getError();if("FUCKING_BIG_ERROR"===N)return!1;I=P.instance({isFloat:!1,S:!0,array:k,width:H});N=b.getError();if(N!==b.NO_ERROR)return!1}catch(ra){return!1}la.P();b.viewport(0,0,H,H);b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);xa.set("s0");
I.Bc(0);ma.l(!0,!0);k=4*H*H;N=new Uint8Array(k);b.readPixels(0,0,H,H,b.RGBA,b.UNSIGNED_BYTE,N);H=!0;for(var ha=0;ha<k;++ha)H=H&&3>Math.abs(N[ha]-127);I.remove();la.da();return H}var m=0,q=null,g=0,v=null,B=null,r=null,p=null,y=null,w=null,f=!1,n=[],F={isFloat:!1,isPot:!0,isLinear:!1,isMipmap:!1,isAnisotropicFiltering:!1,isMirrorX:!1,isMirrorY:!1,isSrgb:!1,isKeepArray:!1,isFlipY:null,width:0,height:0,url:null,array:null,data:null,I:null,Pb:null,Je:!1,S:!1,la:null,jb:4,Xb:0},L=!1,E=null,Q=null,G=[[1,
0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],J=!1,u=!1,t=new Float32Array(1),D=new Int32Array(t.buffer),K={Qb:null,Rb:null},P={A:function(){f||(y=[b.RGBA,null,b.RGBA,b.RGBA],w=[b.RGBA,null,b.RGBA,b.RGBA],q=[b.TEXTURE0,b.TEXTURE1,b.TEXTURE2,b.TEXTURE3,b.TEXTURE4,b.TEXTURE5,b.TEXTURE6,b.TEXTURE7],J="undefined"!==typeof JEContext,u="undefined"!==typeof ba,J&&JEContext.Ig()&&q.push(b.TEXTURE8,b.TEXTURE9),v=[-1,-1,-1,-1,-1,-1,-1,-1],p=[b.UNSIGNED_BYTE,b.FLOAT,b.FLOAT],f=!0)},Ge:function(){if(!B){for(var k=new Float32Array(16384),
I=0;16384>I;++I)k[I]=2*Math.random()-1;B={random:P.instance({isFloat:!0,isPot:!0,array:k,width:64}),Nd:P.instance({isFloat:!1,isPot:!0,width:1,array:new Uint8Array([0,0,0,0])})}}P.wf()},zg:function(){return B.Nd},wf:function(){p[1]=ba.Lb(b)},ef:function(){w=y=[b.RGBA,b.RGBA,b.RGBA,b.RGBA]},Bd:function(k){A.set("s1");la.P();var I=k.F(),H=k.U();b.viewport(0,0,I,H);k.g(0);ma.l(!1,!1)},Og:function(k,I){P.Bd(k);b.readPixels(0,0,k.F(),k.U(),b.RGBA,b.UNSIGNED_BYTE,I)},Pg:function(k,I){P.Bd(k);return ba.pb(0,
0,k.F(),k.U(),I)},Uc:function(k,I,H,N,ha,ra,za){k.activeTexture(k.TEXTURE0);var x=k.createTexture();k.bindTexture(k.TEXTURE_2D,x);ha=ha instanceof Float32Array?ha:new Float32Array(ha);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,ra);k.texImage2D(k.TEXTURE_2D,0,k.RGBA,
H,N,0,k.RGBA,k.FLOAT,ha);k.bindTexture(k.TEXTURE_2D,null);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1);za&&(la.da(),A.Ma(k));k.viewport(0,0,H,N);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,I,0);k.bindTexture(k.TEXTURE_2D,x);za?ma.l(!0,!0):U.Wa(k);k.deleteTexture(x);f&&(v[0]=-1,r=null,m=0)},vb:function(k){k!==m&&(b.activeTexture(q[k]),m=k)},instance:function(k){function I(){R=void 0!==x.I.videoWidth?x.I.videoWidth:x.I.width;T=void 0!==x.I.videoHeight?x.I.videoHeight:x.I.height}
function H(C){var S=b.getError();if("FUCKING_BIG_ERROR"===S)return!1;b.texImage2D(b.TEXTURE_2D,0,ia,da,ea,C);S=b.getError();S!==b.NO_ERROR&&da!==b.RGBA&&(da=b.RGBA,b.texImage2D(b.TEXTURE_2D,0,ia,da,ea,C));return!0}function N(){if(!Ab){a(sa);Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,Aa);x.isPot?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,x.isMirrorX?b.MIRRORED_REPEAT:b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,x.isMirrorY?b.MIRRORED_REPEAT:b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,
b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE));x.isAnisotropicFiltering&&"undefined"!==typeof JESETTINGS&&b.texParameterf(b.TEXTURE_2D,JEContext.mg().TEXTURE_MAX_ANISOTROPY_EXT,JESETTINGS.Af);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,x.isLinear?b.LINEAR:b.NEAREST);x.isLinear?b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,x.isMipmap&&!Ka?b.NEAREST_MIPMAP_LINEAR:b.LINEAR):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,x.isMipmap&&!Ka?b.NEAREST_MIPMAP_NEAREST:
b.NEAREST);da=y[x.jb-1];ia=w[x.jb-1];ea=p[nb];if(ba.ia()){var C=ba.we();da===b.RGBA&&ea===b.FLOAT?x.isMipmap||x.isLinear?ia=Ca.ye(b):ba.Ec()?C&&(ia=C):ia=b.RGBA16F||b.RGBA:da===b.RGB&&ea===b.FLOAT&&C&&(ia=C,da=b.RGBA)}if(x.S&&!x.isFloat||x.isFloat&&x.isMipmap&&Ca.Ne())ia=ba.xe(),ea=ba.Lb(b);x.Xb&&(ab=x.Xb);x.isSrgb&&4===x.jb&&(da=JEContext.xg());if(x.I)H(x.I);else if(x.url)H(Ga);else if(ta){C=ta;try{"FUCKING_BIG_ERROR"!==b.getError()&&(b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,da,ea,C),b.getError()!==
b.NO_ERROR&&(b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,da,ea,null),b.getError()!==b.NO_ERROR&&b.texImage2D(b.TEXTURE_2D,0,b.RGBA,R,T,0,b.RGBA,b.UNSIGNED_BYTE,null)))}catch(gc){b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,da,ea,null)}x.isKeepArray||(ta=null)}else C=b.getError(),"FUCKING_BIG_ERROR"!==C&&(b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,da,ea,null),C=b.getError(),C!==b.NO_ERROR&&(da=b.RGBA,x.S&&ea!==b.FLOAT&&(ea=b.FLOAT,b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,da,ea,null))));if(x.isMipmap)if(!Ka&&ca)ca.Kb(),bb=
!0;else if(Ka){C=Math.log2(Math.min(R,T));Ra=Array(1+C);Ra[0]=sa;for(var S=1;S<=C;++S){var ka=Math.pow(2,S),V=R/ka;ka=T/ka;var La=b.createTexture();a(La);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,ia,V,ka,0,da,ea,null);a(null);Ra[S]=La}bb=!0}a(null);v[m]=-1;Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);Ta=!0;x.la&&ca&&(x.la(ca),x.la=null)}}function ha(){for(var C=R*T,S=2*C,ka=3*C,V=0;V<C;++V)ya[0][V]=
Ua[V],ya[1][V]=Ua[V+C],ya[2][V]=Ua[V+S],ya[3][V]=Ua[V+ka]}function ra(){var C=R*T*4;Da=[new Uint8Array(C),new Uint8Array(C),new Uint8Array(C),new Uint8Array(C)];ya=[new Float32Array(Da[0].buffer),new Float32Array(Da[1].buffer),new Float32Array(Da[2].buffer),new Float32Array(Da[3].buffer)];cb=new Uint8Array(4*C);Ua=new Float32Array(cb.buffer);Va=!0}function za(){Ea.wb=new Uint8Array(R*T*4);Ea.Vc=new Float32Array(Ea.buffer);Ea.Ub=!0}var x=Object.assign({},F,k),Wa=g++;null===x.isFlipY&&(x.isFlipY=x.url||
x.array?!0:!1);x.data&&(x.array="string"===typeof x.data?Ib(x.data):x.isFloat?new Float32Array(x.data):new Uint8Array(x.data),x.isFlipY=!1);var nb=0,Bb=x.I?!0:!1,Xa=null,ob=null,Cb=!1,pb=null;x.S=x.S||x.isFloat;x.S&&(nb=1);!x.Je&&x.isFloat&&u&&!ba.Ec()&&(x.isFloat=!1);x.isFloat&&(nb=2);x.isAnisotropicFiltering&&J&&!JEContext.Cg()&&(x.isAnisotropicFiltering=!1);var sa=x.Pb||b.createTexture(),Ga=null,ta=!1,R=0,T=0,Ta=!1,Ab=!1,Va=!1,ya=null,Da=null,cb=null,Ua=null,ia=null,da=null,ea=null,Aa=x.isFlipY,
Vb=(k=x.S&&x.isMipmap)&&Ca.Yd(),Ka=k&&Vb?!0:!1,Ra=null,ab=-1,bb=!1,Ea={Ub:!1,wb:null,Vc:null};x.width&&(R=x.width,T=x.height?x.height:R);var ca={get:function(){return sa},F:function(){return R},U:function(){return T},Ag:function(){return x.url},Dg:function(){return x.isFloat},Fg:function(){return x.S},Gg:function(){return x.isLinear},Kb:function(){b.generateMipmap(b.TEXTURE_2D)},Wd:function(C,S){Ka?(C||(C=ca.Zc()),P.vb(S),a(Ra[C]),v[S]=-1):ca.g(S)},Zc:function(){-1===ab&&(ab=Math.log(R)/Math.log(2));
return ab},qe:function(C){if(Ka){C||(C=ca.Zc());A.set("s11");P.vb(0);for(var S=R,ka=T,V=1;V<=C;++V)S/=2,ka/=2,A.pa("u7",.25/S,.25/ka),b.viewport(0,0,S,ka),a(Ra[V-1]),b.framebufferTexture2D(la.Za(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,Ra[V],0),ma.l(!1,1===V);v[0]=-1}else ca.Kb()},Xg:function(C){(Bb=!Tb.qf(C))?(ta=null,x.I=C,I()):ta=C},g:function(C){if(!Ta)return!1;P.vb(C);if(v[C]===Wa)return!1;a(sa);v[C]=Wa;return!0},Bc:function(C){b.activeTexture(q[C]);m=C;a(sa);v[C]=Wa},u:function(){r=ca;b.framebufferTexture2D(la.Za(),
b.COLOR_ATTACHMENT0,b.TEXTURE_2D,sa,0)},aa:function(){r=ca;b.viewport(0,0,R,T);b.framebufferTexture2D(la.Za(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,sa,0)},tc:P.tc,resize:function(C,S){R=C;T=S;N()},clone:function(C){C=P.instance({width:R,height:T,S:x.S,isFloat:x.isFloat,isLinear:x.isLinear,isMirrorY:x.isMirrorY,isFlipY:C?!Aa:Aa,isPot:x.isPot});xa.set("s0");la.da();C.u();b.viewport(0,0,R,T);ca.g(0);ma.l(!0,!0);return C},jf:function(){b.viewport(0,0,R,T)},remove:function(){b.deleteTexture(sa);Ab=!0;n.splice(n.indexOf(ca),
1);ca=null},refresh:function(){ca.Bc(0);Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);Bb?b.texImage2D(b.TEXTURE_2D,0,ia,da,ea,x.I):b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,da,ea,ta);Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},Ad:function(){Va||ra();b.readPixels(0,0,R,4*T,b.RGBA,b.UNSIGNED_BYTE,cb);ha();return ya},Ze:function(){Va||ra();return ba.pb(0,0,R,4*T,cb).then(function(){ha();return ya})},af:function(){Ea.Ub||za();b.readPixels(0,0,R,T,b.RGBA,b.UNSIGNED_BYTE,Ea.wb);return Ea.Vc},$e:function(){Ea.Ub||
za();return ba.pb(0,0,R,T,Ea.wb)},Jc:function(C){la.P();A.set("s12");ca.g(0);if(C)b.viewport(0,0,R,T),A.mc("u8",.25,.25,.25,.25),ma.l(!1,!0);else for(C=0;4>C;++C)b.viewport(0,T*C,R,T),A.mc("u8",G[C]),ma.l(!1,0===C)},vf:function(C){var S=ea===p[0]&&!h();a(sa);Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);S?(Cb||(Xa=document.createElement("canvas"),Xa.width=R,Xa.height=T,ob=Xa.getContext("2d"),pb=ob.createImageData(R,T),Cb=!0),pb.data.set(C),ob.putImageData(pb,0,0),b.texImage2D(b.TEXTURE_2D,0,ia,da,ea,
Xa)):b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,da,ea,C);v[m]=Wa;Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},ih:function(C,S){a(sa);S&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);b.texImage2D(b.TEXTURE_2D,0,ia,da,ea,C);v[m]=Wa;S&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},Vg:function(C,S){var ka=R*T,V=4*ka;C=x.S?C?"RGBE":"JSON":"RGBA";S&&(C=S);S=ba.ia()&&!1;var La=null;switch(C){case "RGBE":La="s42";break;case "JSON":La=S?"s0":"s12";break;case "RGBA":case "RGBAARRAY":La="s6"}Va||("RGBA"===C||"RGBE"===C||"RGBAARRAY"===
C?(Da=new Uint8Array(V),Va=!0):"JSON"!==C||S||ra());la.P();A.set(La);ca.g(0);V=null;if("RGBA"===C||"RGBE"===C||"RGBAARRAY"===C){b.viewport(0,0,R,T);ma.l(!0,!0);b.readPixels(0,0,R,T,b.RGBA,b.UNSIGNED_BYTE,Da);if("RGBAARRAY"===C)return{data:Da};L||(E=document.createElement("canvas"),Q=E.getContext("2d"),L=!0);E.width=R;E.height=T;ka=Q.createImageData(R,T);ka.data.set(Da);Q.putImageData(ka,0,0);V=E.toDataURL("image/png")}else if("JSON"===C)if(S)V=new Float32Array(ka),b.viewport(0,0,R,T),ma.l(!0,!0),
b.readPixels(0,0,R,T,b.RGBA,b.FLOAT,V);else{for(V=0;4>V;++V)b.viewport(0,T*V,R,T),A.mc("u8",G[V]),ma.l(!V,!V);ca.Ad();V=Array(ka);for(S=0;S<ka;++S)V[4*S]=ya[0][S],V[4*S+1]=ya[1][S],V[4*S+2]=ya[2][S],V[4*S+3]=ya[3][S]}return{format:C,data:V,width:R,height:T,isMirrorY:x.isMirrorY,isFlipY:"RGBA"===C?x.isFlipY:!x.isFlipY}}};x.isMipmap&&!Ka&&Ta&&!bb&&(ca.Kb(),bb=!0);if(x.url)a(sa),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,null),Ga=new Image,Ga.Nf="Anonymous",Ga.crossOrigin="Anonymous",
Ga.src=x.url,Ga.onload=function(){R=Ga.width;T=Ga.height;N()};else if(x.I){var Db=function(){I();R?N():setTimeout(Db,1)};Db()}else x.array?(x.S&&!x.isFloat?x.array instanceof Uint16Array?(ta=x.array,N()):e()?(ta=d(x.array),N()):(N(),P.Uc(b,sa,ca.F(),ca.U(),x.array,Aa,!0)):(ta=x.isFloat?x.array instanceof Float32Array?x.array:new Float32Array(x.array):x.array instanceof Uint8Array?x.array:new Uint8Array(x.array),N()),x.isKeepArray||(ta&&ta!==x.array&&(ta=null),delete x.array)):x.Pb?Ta=!0:N();ca.wg=
ca.F;x.la&&Ta&&(x.la(ca),x.la=null);n.push(ca);return ca},P:function(k){k!==m&&(b.activeTexture(q[k]),m=k);v[k]=-1;a(null)},Df:function(k){B.random.g(k)},tc:function(){r=null;b.framebufferTexture2D(la.Za(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0)},reset:function(){0!==m&&b.activeTexture(q[0]);for(var k=0;k<q.length;++k)v[k]=-1;m=-1},Sg:function(){m=-1},sf:function(){for(var k=0;k<q.length;++k)P.P(k)},Wc:function(){B&&(B.random.remove(),B.Nd.remove())},hh:function(k,I){if("RGBA"===k.format||"RGBE"===
k.format){var H=new Image;H.src=k.data;H.onload=function(){P.instance({isMirrorY:k.isMirrorY,isFlipY:k.isFlipY,isFloat:!1,I:H,la:function(N){if("RGBA"===k.format)I(N);else{var ha=k.width,ra=k.height,za=P.instance({isMirrorY:k.isMirrorY,isFloat:!0,width:ha,height:ra,isFlipY:k.isFlipY});la.da();b.viewport(0,0,ha,ra);A.set("s43");za.u();N.g(0);ma.l(!0,!0);P.P(0);I(za);b.flush();setTimeout(N.remove,50)}}})}}else"JSON"===k.format?I(P.instance({isFloat:!0,isFlipY:k.isFlipY,width:k.width,height:k.height,
array:new Float32Array(k.data)})):I(!1)},de:d,m:function(){r&&(ua.da(),P.tc(),ua.P());P.sf();n.slice(0).forEach(function(k){k.remove()});n.splice(0);f=!1;g=0;"undefined"!==typeof Ca&&Ca.m();B=null}};return P}(),Nb=function(){return{instance:function(a){var c=[Ba.instance(a),Ba.instance(a)],d=[c[1],c[0]],e=d,h={cf:function(l){e[1].u();e[0].g(l);h.Id()},Wg:function(l){e[1].aa();e[0].g(l);h.Id()},Id:function(){e=e===c?d:c},refresh:function(){e[0].refresh();e[1].refresh()},g:function(l){e[0].g(l)},Cf:function(l){e[1].g(l)},
qg:function(){return e[0]},ug:function(){return e[1]},remove:function(){e[0].remove();e[1].remove();e=null}};return h}}}(),ma=function(){function a(g){var v={ba:null,K:null};v.ba=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,v.ba);g.bufferData(g.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),g.STATIC_DRAW);v.K=g.createBuffer();g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,v.K);g.bufferData(g.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2]),g.STATIC_DRAW);return v}var c=null,d=0,e=!1,h=[],l=-2,m=-2,q={reset:function(){m=
l=-2},A:function(){e||(c=a(b),q.Ea(),e=!0)},instance:function(g){var v=d++,B=g.K?g.K.length:0,r="undefined"===typeof g.mode?b.STATIC_DRAW:g.mode,p=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,p);b.bufferData(b.ARRAY_BUFFER,g.ba instanceof Float32Array?g.ba:new Float32Array(g.ba),r);l=v;var y=null,w=null,f=null;if(g.K){y=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,y);var n=null;65536>g.K.length?(n=Uint16Array,w=b.UNSIGNED_SHORT,f=2):(n=Uint32Array,w=b.UNSIGNED_INT,f=4);n=g.K instanceof n?
g.K:new n(g.K);b.bufferData(b.ELEMENT_ARRAY_BUFFER,n,r);m=v}var F={Xd:function(L){l!==v&&(b.bindBuffer(b.ARRAY_BUFFER,p),l=v);L&&xa.nc()},Ud:function(){m!==v&&(b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,y),m=v)},bind:function(L){F.Xd(L);F.Ud()},Pf:function(){b.drawElements(b.TRIANGLES,B,w,0)},Qf:function(L,E){b.drawElements(b.TRIANGLES,L,w,E*f)},remove:function(){b.deleteBuffer(p);g.K&&b.deleteBuffer(y);F=null}};h.push(F);return F},Ea:function(){-1!==l&&(b.bindBuffer(b.ARRAY_BUFFER,c.ba),l=-1);-1!==m&&(b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
c.K),m=-1)},l:function(g,v){g&&ma.Ea();v&&xa.xa();b.drawElements(b.TRIANGLES,3,b.UNSIGNED_SHORT,0)},Wa:function(g){g=g||b;var v=a(g);g.bindBuffer(g.ARRAY_BUFFER,v.ba);g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,v.K);xa.rb(g);g.clear(g.COLOR_BUFFER_BIT);g.drawElements(g.TRIANGLES,3,g.UNSIGNED_SHORT,0);g.flush();g.bindBuffer(g.ARRAY_BUFFER,null);g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null);g.deleteBuffer(v.ba);g.deleteBuffer(v.K);q.reset();e&&(q.Ea(),xa.xa())},Wc:function(){var g=b,v=c;g.deleteBuffer(v.ba);g.deleteBuffer(v.K)},
m:function(){q.Wc();h.forEach(function(g){g.remove()});b.bindBuffer(b.ARRAY_BUFFER,null);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,null);q.reset();e=!1;h.splice(0);d=0}};return q}(),la=function(){var a=null,c=null,d=null,e=!1,h=[],l={J:-2,Tc:1},m={fb:function(){return e},A:function(){if(!e){a=b.createFramebuffer();var q=ba.ia();c=q&&b.DRAW_FRAMEBUFFER?b.DRAW_FRAMEBUFFER:b.FRAMEBUFFER;d=q&&b.READ_FRAMEBUFFER?b.READ_FRAMEBUFFER:b.FRAMEBUFFER;e=!0}},ng:function(){return c},ze:function(){return d},Za:function(){return b.FRAMEBUFFER},
vg:function(){return l},fg:function(){return a},instance:function(q){void 0===q.dd&&(q.dd=!1);var g=q.N?q.N:null,v=q.width,B=void 0!==q.height?q.height:q.width,r=a,p=null,y=!1,w=!1,f=0;g&&(v=v?v:g.F(),B=B?B:g.U());var n={Fd:function(){y||(r=b.createFramebuffer(),y=!0,f=l.Tc++)},Pd:function(){n.Fd();n.u();p=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,p);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,v,B);b.framebufferRenderbuffer(c,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,p);b.clearDepth(1)},
bind:function(F,L){f!==l.J&&(b.bindFramebuffer(c,r),l.J=f);g&&g.u();L&&b.viewport(0,0,v,B);F&&b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},Bf:function(){f!==l.J&&(b.bindFramebuffer(c,r),l.J=f)},clear:function(){b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},Jf:function(){b.clear(b.COLOR_BUFFER_BIT)},Kf:function(){b.clear(b.DEPTH_BUFFER_BIT)},jf:function(){b.viewport(0,0,v,B)},u:function(){f!==l.J&&(b.bindFramebuffer(c,r),l.J=f)},rtt:function(F){g=F;l.J!==f&&(b.bindFramebuffer(b.FRAMEBUFFER,r),
l.J=f);F.u()},P:function(){b.bindFramebuffer(c,null);l.J=-1},resize:function(F,L){v=F;B=L;p&&(b.bindRenderbuffer(b.RENDERBUFFER,p),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,v,B))},remove:function(){r===a||w||(b.bindFramebuffer(c,r),b.framebufferTexture2D(c,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),p&&b.framebufferRenderbuffer(c,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,null),b.bindFramebuffer(c,null),b.deleteFramebuffer(r),p&&b.deleteRenderbuffer(p));w=!0}};q.dd&&n.Pd();h.push(n);return n},
P:function(){b.bindFramebuffer(c,null);l.J=-1},tf:function(){b.bindFramebuffer(c,null);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);b.viewport(0,0,ba.F(),ba.U());l.J=-1},reset:function(){l.J=-2},da:function(){0!==l.J&&(b.bindFramebuffer(c,a),l.J=0)},clear:function(){b.viewport(0,0,ba.F(),ba.U());b.clear(b.COLOR_BUFFER_BIT)},m:function(){m.P();h.forEach(function(q){q.remove()});null!==a&&(b.deleteFramebuffer(a),a=null);m.reset();e=!1;h.splice(0);l.Tc=1}};return m}(),ba=function(){function a(){e=
"undefined"===typeof Qa?JEContext:Qa;h=!0}function c(f,n){for(var F=0;F<f.length;++F){var L=n.getExtension(f[F]);if(L)return L}return null}function d(){null!==p.tb&&(clearInterval(p.tb),p.tb=null);p.Ja=!1}var e=null,h=!1,l={fd:!1,pc:null,qc:null,kd:!1,Me:!1,rc:null,ld:!1,sc:null,gd:!1,xb:null,He:!1,yb:null,Ie:!1},m=null,q={fa:!0,ga:!0,Jb:!0,zd:!1},g=null,v=!0,B=null,r=null,p={Ja:!1,sa:null,$a:null,Ob:-1,ta:null,tb:null},y="undefined"===typeof window?{}:window,w={A:function(){if(h)return!0;w.reset();
h||a();var f=b;if(!m.fd){m.pc=w.Pc(f);y.GL_EXT_FLOAT=m.pc;m.kd=m.pc?!0:!1;if(m.kd||w.ia())m.qc=w.Qc(f),m.Me=m.qc?!0:!1,y.GL_EXT_FLOATLINEAR=m.qc;m.fd=!0}if(!m.gd){m.rc=w.Va(f);m.rc&&(m.ld=!0,y.GL_EXT_HALFFLOAT=m.rc);if(m.ld||w.ia())m.sc=w.Rc(f),y.GL_EXT_HALFFLOATLINEAR=m.sc;m.Bg=m.sc?!0:!1;m.gd=!0}m.xb=w.Nc(f);m.He=m.xb?!0:!1;y.GL_EXT_COLORBUFFERFLOAT=m.xb;m.yb=w.Oc(f);m.Ie=m.yb?!0:!1;y.GL_EXT_COLORBUFFERHALFFLOAT=m.yb;la.A();Ba.A();if(!w.he())return!1;ma.A();Ba.Ge();return!0},reset:function(){m=
Object.assign({},l);g=Object.assign({},q)},F:function(){h||a();return e.F()},U:function(){h||a();return e.U()},ia:function(){h||a();return e.ia()},Mc:function(f){w.Nc(f);w.Oc(f);w.Pc(f);w.Qc(f);w.Va(f);w.Rc(f)},Nc:c.bind(null,["EXT_color_buffer_float","WEBGL_color_buffer_float","OES_color_buffer_float"]),Oc:c.bind(null,["EXT_color_buffer_half_float","WEBGL_color_buffer_half_float","OES_color_buffer_half_float"]),Pc:c.bind(null,["OES_texture_float","MOZ_OES_texture_float","WEBKIT_OES_texture_float"]),
Qc:c.bind(null,["OES_texture_float_linear","MOZ_OES_texture_float_linear","WEBKIT_OES_texture_float_linear"]),Va:c.bind(null,["OES_texture_half_float","MOZ_OES_texture_half_float","WEBKIT_OES_texture_half_float"]),Rc:c.bind(null,["OES_texture_half_float_linear","MOZ_OES_texture_half_float_linear","WEBKIT_OES_texture_half_float_linear"]),Lb:function(f){var n=w.Va(f);return n&&n.HALF_FLOAT_OES?n.HALF_FLOAT_OES:f.HALF_FLOAT||f.FLOAT},we:function(){return r||b.RGBA32F||b.RGBA},xe:function(){return B||
b.RGBA16F||b.RGBA},te:function(){return g},Ec:function(){return g.fa},Ff:function(){return g.ga},Ef:function(){return g.Jb},Zd:function(){return g.zd&&v},Ld:function(f){v=f;!f&&p.Ja&&(b.deleteSync(p.$a),b.bindBuffer(p.ta,null),p.Ja=!1)},sb:function(f,n,F){function L(){f.bindTexture(f.TEXTURE_2D,null);f.bindFramebuffer(E,null);f.deleteTexture(J);f.deleteFramebuffer(G)}var E=f.FRAMEBUFFER,Q=f.NEAREST,G=f.createFramebuffer();f.bindFramebuffer(E,G);var J=f.createTexture();f.activeTexture(f.TEXTURE0);
f.bindTexture(f.TEXTURE_2D,J);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,Q);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,Q);f.texImage2D(f.TEXTURE_2D,0,n,3,3,0,f.RGBA,F,null);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,J,0);if(f.checkFramebufferStatus(f.READ_FRAMEBUFFER||f.FRAMEBUFFER)!==f.FRAMEBUFFER_COMPLETE)return L(),
!1;xa.lc(f);f.clearColor(0,0,0,0);f.viewport(0,0,3,3);f.disable(f.DEPTH_TEST);f.clear(f.COLOR_BUFFER_BIT);ma.Wa(f);f.bindFramebuffer(E,null);xa.Ma(f);f.activeTexture(f.TEXTURE0);f.bindTexture(f.TEXTURE_2D,J);ma.Wa(f);n=new Uint8Array(36);f.readPixels(0,0,3,3,f.RGBA,f.UNSIGNED_BYTE,n);L();for(F=0;36>F;++F)if(3!==F%4&&3<Math.abs(n[F]-127))return!1;return!0},Bb:function(f){var n={fa:!1,ga:!1};f.disable(f.BLEND);f.clearColor(0,0,0,0);f.clear(f.COLOR_BUFFER_BIT);f.RGBA32F&&w.sb(f,f.RGBA32F,f.FLOAT)&&(n.fa=
!0,r=f.RGBA32F);!n.fa&&w.sb(f,f.RGBA,f.FLOAT)&&(n.fa=!0,r=f.RGBA);var F=w.Lb(f);B=null;f.RGBA16F&&w.sb(f,f.RGBA16F,F)&&(n.ga=!0,B=f.RGBA16F);!n.ga&&w.sb(f,f.RGBA,F)&&(n.ga=!0,B=f.RGBA);return n},ie:function(){var f=la.instance({width:2});f.Fd();var n=Ba.instance({width:2,isFloat:!0,jb:3});f.u();n.u();b.flush();b.checkFramebufferStatus(la.ze())!==b.FRAMEBUFFER_COMPLETE?(Ba.ef(),g.Jb=!1):g.Jb=!0;f.remove();n.remove()},je:function(){var f=!1;w.ia()&&(f="PIXEL_PACK_BUFFER STREAM_READ SYNC_GPU_COMMANDS_COMPLETE WAIT_FAILED fenceSync deleteSync createBuffer".split(" ").every(function(n){return"undefined"!==
typeof b[n]}));g.zd=f},he:function(){var f=w.Bb(b);Object.assign(g,f);if(!g.fa&&!g.ga)return!1;w.ie();w.je();return!0},pb:function(f,n,F,L,E){if(!w.Zd())return b.readPixels(f,n,F,L,b.RGBA,b.UNSIGNED_BYTE,E),Promise.resolve(E);null===p.sa&&(p.ta=b.PIXEL_PACK_BUFFER,p.sa=b.createBuffer(),p.Ob=-1);b.bindBuffer(p.ta,p.sa);E.byteLength!==p.Ob&&(b.bufferData(p.ta,E.byteLength,b.STREAM_READ),p.Ob=E.byteLength);b.readPixels(f,n,F,L,b.RGBA,b.UNSIGNED_BYTE,0);p.$a=b.fenceSync(b.SYNC_GPU_COMMANDS_COMPLETE,0);
b.flush();return new Promise(function(Q,G){function J(){if(!p.Ja)return d(),G(),!1;switch(b.clientWaitSync(p.$a,0,0)){case b.TIMEOUT_EXPIRED:case b.WAIT_FAILED:return!1;default:return d(),b.deleteSync(p.$a),b.getBufferSubData(p.ta,0,E),b.bindBuffer(p.ta,null),Q(E),!0}}d();p.Ja=!0;J()||(p.tb=setInterval(J,0))})},m:function(){d();Ba.m();xa.m();la.m();ma.m();null!==p.sa&&(b.deleteBuffer(p.sa),p.sa=null);h=!1}};return w}(),U=ma,ua=la,Y=Ba,Ca=function(){function a(G,J,u,t){n.texParameteri(n.TEXTURE_2D,
n.TEXTURE_MIN_FILTER,t?n.NEAREST_MIPMAP_NEAREST:n.LINEAR);var D=null;if(null!==u)try{D=n.getError();if("FUCKING_BIG_ERROR"===D)return!1;n.texImage2D(n.TEXTURE_2D,0,G,4,4,0,n.RGBA,J,u);D=n.getError();if(D!==n.NO_ERROR)return!1}catch(K){return!1}t&&n.generateMipmap(n.TEXTURE_2D);n.clear(n.COLOR_BUFFER_BIT);U.Wa(n);D=n.getError();if("FUCKING_BIG_ERROR"===D)return!1;n.readPixels(0,0,2,2,n.RGBA,n.UNSIGNED_BYTE,B);D=n.getError();D===n.INVALID_OPERATION&&"undefined"!==typeof n.PIXEL_PACK_BUFFER&&(n.bindBuffer(n.PIXEL_PACK_BUFFER,
null),n.readPixels(0,0,2,2,n.RGBA,n.UNSIGNED_BYTE,B),D=n.getError());if(D!==n.NO_ERROR)return!1;u=!0;for(t=0;16>t;++t)u=u&&4>Math.abs(B[t]-127);u&&(g.wd=J,g.cd=G);return u}function c(G,J){return F.fa&&a(G,n.FLOAT,new Float32Array(r),J)?(q=m.xc,!0):!1}function d(G,J,u){if(!F.ga)return!1;var t=Ba.de(r),D=ba.Va(n);if(D&&D.HALF_FLOAT_OES&&a(G,D.HALF_FLOAT_OES,t,J)||n.HALF_FLOAT&&a(G,n.HALF_FLOAT,t,J))return q=m.Ba,!0;t=new Float32Array(r);if(a(G,n.FLOAT,t,J))return q=m.Ba,!0;n.bindTexture(n.TEXTURE_2D,
u);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,2,2,0,n.RGBA,n.UNSIGNED_BYTE,null);n.bindFramebuffer(g.Ta,Q);Ba.Uc(n,u,2,2,t,!1,!1);n.bindFramebuffer(g.Ta,null);n.bindTexture(n.TEXTURE_2D,u);return a(G,null,null,J)?(q=m.Ba,!0):!1}function e(G,J,u){v=!0;if(d(G,!0,u)||c(J,!0))return!0;v=!1;return d(G,!1,u)||c(J,!1)?!0:!1}function h(G){if(q===m.R){n=G||b;q=m.RGBA8;v=!0;ba.Mc(n);F||(F=ba.Bb(n));ua.reset();Q=n.createFramebuffer();g.Ta=n.DRAW_FRAMEBUFFER||n.FRAMEBUFFER;n.bindFramebuffer(g.Ta,null);n.clearColor(0,
0,0,0);n.viewport(0,0,2,2);A.R();L=A.Ma(n);G=n.createTexture();n.activeTexture(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,G);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST);E=G;var J=G=n.RGBA,u=n.RGBA16F,t=n.RGBA32F;t&&(G=t);u&&(J=u);if((u||t)&&e(J,G,E))return l(),!0;G=J=n.RGBA;if(e(J,G,E))return l(),!0;q=m.RGBA8;l();return!1}}function l(){n.deleteProgram(L.oa);n.deleteTexture(E);
E=L=null}for(var m={R:-1,xc:3,Ba:2,RGBA8:0},q=m.R,g={wd:null,cd:null,Ta:null},v=!0,B=new Uint8Array(16),r=Array(64),p=0;4>p;++p)for(var y=0;4>y;++y){var w=0===(y+p)%2?1:0,f=4*p+y;r[4*f]=w;r[4*f+1]=w;r[4*f+2]=w;r[4*f+3]=w}var n=null,F=null,L=null,E=null,Q=null;return{Yd:function(G){h(G);return v},Dc:function(G,J){q===m.R&&(typeof("undefined"!==J)&&(F=J),h(G));return q!==m.RGBA8},Eg:function(G){h(G);return q===m.xc},Ne:function(G){h(G);return q===m.Ba},og:function(G){h(G);return g.wd},ye:function(G){h(G);
return g.cd},m:function(){n=null;v=!0;q=m.R;F=null}}}(),Wb=function(){return{instance:function(a){var c=Y.instance(a.alpha),d=Y.instance(a.beta);return{le:function(){c.g(1);d.g(2)}}}}}(),Gb=function(){return{instance:function(a){var c=null,d=!1,e=!1,h=null,l=!1,m=!1,q=null,g="undefined"===typeof a.preprocessing?!1:a.preprocessing,v="undefined"===typeof a.preprocessingSize?a.size:a.preprocessingSize;a.mask&&(d=!0,aa&&void 0!==aa.Td&&(a.mask=aa.Td+a.mask),c=Y.instance({isFloat:!1,url:a.mask}));var B=
!1;a.customInputShader&&(B="s44",A.zc({name:"_",id:B,h:a.customInputShader,gh:["uSource"],precision:"lowp"}),A.T(B,[{type:"1i",name:"_",value:0}]));switch(g){case "sobel":q="s31";l=!0;break;case "meanNormalization":q="s32";l=!0;break;case "grayScale":q="s28";l=!1;break;case "grayScaleTilt":q="s29";m=!0;l=!1;break;case "rgbGrayTilt":q="s30";m=!0;l=!1;break;case "copy":q=B?B:"s0";break;case "inputLightRegulation":q=B?B:"s28";h=Xb.instance({bd:v,vd:a.size,rd:a.nBlurPass,eb:!1});e=!0;break;case "inputMix0":q=
"none";h=Yb.instance({D:v,Od:a.varianceMin,Cc:a.blurKernelSizePx,eb:!1});e=!0;break;case "direct":case "none":q="abort";break;default:q="s3"}m&&A.T(q,[{name:"u26",type:"1f",value:a.tilt}]);d&&(q+="Mask");var r=Y.instance({isFloat:!1,isPot:!1,width:a.size}),p={F:function(){return v},Mb:function(){return p.F()},Ce:function(){return e?h.Nb():r},V:function(y){ua.da();"abort"!==q&&("none"!==q&&(A.set(q),l&&A.H("u27",1/a.size),r.aa(),d&&c.g(1),U.l(!1,!1),r.g(0),y=r),e&&h.process(y))},m:function(){r.remove();
d&&c.remove()}};return p}}}(),Hb=function(){return{instance:function(a){function c(k){h.forEach(function(I,H){l[H][0]=k[0][I];l[H][1]=k[1][I];l[H][2]=k[2][I];l[H][3]=k[3][I]});return l}"undefined"===typeof a.normalize&&(a.normalize=!1);var d={input:null,Qa:null,Sb:null,Z:null,lb:null,cc:null,dc:null},e=null,h=[],l=[],m=!1,q=null,g=!0,v=-1,B=a.isReorganize?a.isReorganize:!1,r=a.kernelsCount?!0:!1,p=a.dynPelu?Wb.instance(a.dynPelu):!1,y=p?!0:!1,w={isEnabled:!1};a.Le?(a.sparsity="undefined"!==typeof a.sparsity?
a.sparsity:a.nb.Mb(),g=!1):"full"===a.connectivityUp&&(a.sparsity=a.nb.Mb());var f={elu:"s15",elu01:"s16",relu:"s14",arctan:"s18",sigmoid:"s13",copy:"s0",softplus:"s19",dynPelu:"s17"}[a.activation],n=a.sparsity*a.sparsity,F=!1,L=a.size,E="";if(a.maxPooling){switch(a.maxPooling.size){case 2:E="s33";break;case 4:E="s34"}F=!0;L/=a.maxPooling.size;d.cc=Y.instance({isFloat:!0,isPot:!1,width:L})}var Q=void 0!==a.Te&&a.Te?!0:!1,G=null,J=null,u=null;if(Q){G="s45"+a.index.toString();A.ad("s45",G,[((a.normalization.n-
1)/2).toFixed(1)]);A.T(G,[{type:"1i",name:"u1",value:0},{type:"2f",name:"u7",value:[1/a.size,1/a.size]},{type:"1f",name:"u6",value:a.normalization.alpha},{type:"1f",name:"u9",value:a.normalization.beta},{type:"1f",name:"u30",value:a.normalization.k}]);var t={isFloat:!0,isPot:!0,width:a.size};J=Y.instance(t);u=Y.instance(t)}var D=-1,K=null;g&&(d.Z=Y.instance({isFloat:!0,isPot:!1,width:a.size}));d.Qa=Y.instance(a.bias);var P={F:function(){return a.size},Mb:function(){return L},Xc:function(){return a.classesCount},
Vd:function(k){e.g(k)},We:function(){a.remap&&a.remap.isEnabled&&(w={isEnabled:!0,Pe:Y.instance({isFloat:!1,isFlipY:!1,array:new Uint8Array(a.remap.maskTexture.data),width:a.remap.maskTexture.width,isPot:!1}),gb:a.remap.layers.map(function(k){return a.parent.Be(k)}),depth:a.remap.depth})},ff:function(){switch(a.connectivityUp){case "direct":K=Zb.instance(a.connectivity);break;case "square":K=$b.instance(a.connectivity);break;case "squareFast":K=ac.instance(a.connectivity,a.activation);break;case "full":K=
bc.instance(a.connectivity);break;case "conv":v=a.kernelsCount,K=cc.instance(a.connectivity),B&&(d.lb=Y.instance({width:L,isFloat:!0,isFlipY:!1,isPot:!1}))}if(K.ya){var k=a.size*a.sparsity;D=Math.log(k/a.size)/Math.log(2);d.input=Y.instance({isMipmap:!0,isFloat:!0,isPot:!0,width:k,Xb:D});d.Sb=Y.instance({isFloat:!0,isPot:!0,width:a.size})}},V:function(k,I){e=k;K.ya?(d.input.aa(),r&&d.Qa.g(2),K.V(w),d.input.g(0),d.input.qe(D),d.Sb.aa(),r?A.set("s0"):(A.set("s27"),A.H("u25",n),d.Qa.g(1)),d.input.Wd(D,
0),U.l(!1,!1),A.set(f),Q?J.u():d.Z.u(),d.Sb.g(0),y&&p.le(),U.l(!1,!1)):(d.Z.aa(),d.Qa.g(1),K.V());Q&&(A.set(G),u.u(),J.g(0),U.l(!1,!1),A.set("s46"),A.H("u6",1),d.Z.u(),u.g(1),U.l(!1,!1));if(g)return F?(d.cc.aa(),d.Z.g(0),A.set(E),A.pa("u7",1/a.size,1/a.size),U.l(!1,!1),I=d.cc):I=d.Z,I.g(0),B&&(d.lb.u(),A.set("s21"),A.pa("u12",v,L/v),U.l(!1,!1),I=d.lb,d.lb.g(0)),I;var H=d.Z;a.normalize&&(A.set("gpuRawAvg"===m?"s8":"s7"),A.H("u4",1/a.size),d.dc.aa(),d.Z.g(0),U.l(!1,!1),H=d.dc);k=null;switch(m){case "cpuRGBA2Float":H.Jc(!1);
I?k=P.Xe(H).then(q):(H=P.Ye(H),q(H));break;case "cpuMeanFloat":H.Jc(!0);I?k=H.$e().then(q):(H=H.af(),q(H));break;case "gpuRawAvg":case "gpuRaw":H.g(0);case "none":null!==q&&q(H)}I&&null===k&&(k=Promise.resolve());return k},fe:function(k){k&&(m=k.ec||"none",q=k.bc||null);d.Z=Y.instance({isFloat:!0,isPot:!0,isMipmap:!1,width:a.size});k="undefined"!==typeof a.classesCount&&a.classesCount?a.classesCount:a.size*a.size;for(var I=0,H=0,N=0;I<k;++I)h.push(H+(a.size-1-N)*a.size),l.push([-1,-1,-1,-1]),++H,
H===a.size&&(H=0,++N);a.normalize&&(d.dc=Y.instance({isFloat:!0,isPot:!0,width:a.size}))},Xe:function(k){return k.Ze().then(c)},Ye:function(k){k=k.Ad();c(k);return l},m:function(){for(var k in d){var I=d[k];I&&I.remove()}K&&(K.m(),K=null)}};a.nb&&P.ff(a.nb);return P}}}(),Zb=function(){return{instance:function(a){var c=Y.instance(a.weights);return{ya:!0,Ya:function(){return 1},m:function(){c.remove()},Fe:function(){return c},V:function(){A.set("s26");c.g(1);U.l(!1,!1)}}}}}(),bc=function(){return{instance:function(a){var c=
a.fromLayerSize,d=Y.instance(a.weights);return{ya:!0,Ya:function(){return c},m:function(){d.remove()},V:function(e){if(e.isEnabled){A.set("s24");e.Pe.g(3);var h,l=Math.min(e.gb.length,e.depth);for(h=0;h<l;++h)e.gb[h].Vd(4+h)}else A.set("s23");A.H("u16",a.toLayerSize);d.g(1);U.l(!1,!1)}}}}}(),$b=function(){return{instance:function(a){for(var c=a.fromLayerSize,d=a.toLayerSize,e=a.toSparsity,h=e*d,l=h/c,m=c/d,q=0,g=0,v=0,B=Array(e*d*e*d*4),r=Array(e*d*e*d*4),p=Array(c*c),y=0;y<p.length;++y)p[y]=0;y=
Math.floor(e/2);for(var w=.5/d,f=.5/c,n=.5/h,F=0;F<d;++F)for(var L=Math.round(F*m),E=0;E<d;++E){var Q=Math.round(E*m),G=F/d,J=E/d;G+=w;J+=w;for(var u=0;u<e;++u){var t=L+u-y;0>t&&(t+=c);t>=c&&(t-=c);for(var D=0;D<e;++D){var K=q/h,P=g/h,k=Q+D-y;0>k&&(k+=c);k>=c&&(k-=c);var I=t/c,H=k/c;P=1-P-1/h;I+=f;H+=f;K+=n;P+=n;var N=F*e+u,ha=E*e+D;ha=d*e-ha-1;N=ha*d*e+N;B[4*N]=K;B[4*N+1]=P;B[4*N+2]=I;B[4*N+3]=H;H=p[k*c+t]++;N=H%l;I=t*l+N;k=k*l+(H-N)/l;k=c*l-1-k;k=k*c*l+I;r[4*k]=K;r[4*k+1]=P;r[4*k+2]=G;r[4*k+3]=
J;++q>=h&&(q=0,++g);++v}}}p=null;var ra=Y.instance(a.weights);delete a.weights.data;var za=Y.instance({width:h,isFloat:!0,array:new Float32Array(r),isPot:!0});r=null;var x=Y.instance({width:h,isFloat:!0,array:new Float32Array(B),isPot:!0});B=null;return{ya:!0,Ya:function(){return l},m:function(){za.remove();x.remove();ra.remove()},V:function(){A.set("s22");ra.g(1);x.g(2);U.l(!1,!1)}}}}}(),cc=function(){return{instance:function(a){var c=a.kernelsCount,d=a.toSparsity,e=d*a.toLayerSize/a.fromLayerSize,
h=Y.instance(a.weights);return{ya:!0,Ya:function(){return e},yg:function(){return d},Fe:function(){return h},m:function(){h.remove()},V:function(){A.set("s25");A.H("u22",c);A.H("u23",d);A.H("u16",a.toLayerSize);A.H("u24",a.fromLayerSize);h.g(1);U.l(!1,!1)}}}}}(),ac=function(){return{instance:function(a,c){var d=a.fromLayerSize,e=a.toLayerSize,h=a.toSparsity,l=a.stride?a.stride:1,m=h*e/d,q=e<d,g=d/e,v=Y.instance(a.weights),B="s47"+[d.toString(),e.toString(),h.toString(),l.toString(),c].join("_");A.oe(B)||
(a=Ub.re(c,"gl_FragColor","gl_FragColor"),e=[{type:"1f",name:"u16",value:e},{type:"1f",name:"u29",value:l}],q&&e.push({type:"1f",name:"u24",value:d}),d=[(q?m:h).toFixed(1),a],q&&d.push(g.toFixed(1)),A.ad(q?"s39":"s38",B,d),A.T(B,e.concat([{type:"1i",name:"u14",value:0},{type:"1i",name:"u21",value:1},{type:"1i",name:"u13",value:3}])));return{ya:!1,Ya:function(){return m},m:function(){v.remove()},V:function(){A.set(B);v.g(3);U.l(!1,!1)}}}}}(),Xb=function(){return{instance:function(a){var c=a.rd?a.rd:
3,d=a.bd?a.bd:64,e=a.vd?a.vd:64,h=a.eb?!0:!1;a={isFloat:!1,width:d,isPot:!1,isFlipY:!1};var l=Y.instance(a),m=Y.instance(a),q=Y.instance(a),g=Y.instance(a),v=Y.instance({isFloat:!0,width:e,isPot:!1,isFlipY:!1}),B=1/d;return{process:function(r){A.set("s35");g.u();U.l(h,!1);A.set("s36");for(var p=0;p<c;++p)l.u(),A.pa("u7",B,0),U.l(h,!1),q.u(),g.g(0),U.l(h,!1),m.u(),l.g(0),A.pa("u7",0,B),U.l(h,!1),g.u(),q.g(0),U.l(h,!1),p!==c-1&&m.g(0);A.set("s37");v.u();r.g(0);m.g(1);g.g(2);U.l(h,!1);v.g(0)},Nb:function(){return v}}}}}(),
Yb=function(){return{instance:function(a){function c(v){return Y.instance({isFloat:v,width:d.D,isPot:!1,isFlipY:!1})}var d=Object.assign({Od:.1,Cc:9,D:128,eb:!1},a),e=c(!1),h=[c(!1),c(!1),c(!1)],l=[c(!1),c(!1),c(!1)],m=c(!0),q=[e,l[0],l[1]];a="uniform sampler2D u1;const float e=1.1111,g=2.2222;uniform vec2 u31;varying vec2 vv0;void main(){float b=0.,c=0.;for(float a=-e;a<=e;a+=1.){vec2 i=u31*a,j=vv0+i*g;float d=1.2*a/e,f=exp(-d*d);b+=f*texture2D(u1,j).r,c+=f;}b/=c,gl_FragColor=vec4(b,0.,0.,1.);}".replace("1.1111",
Math.round((d.Cc-1)/2).toFixed(2)).replace("2.2222",(1/d.D).toFixed(6));var g={u1:0};A.Ac([{id:"s49",name:"_",h:"uniform sampler2D u1;varying vec2 vv0;const vec3 f=vec3(.2126,.7152,.0722),g=vec3(1.,1.,1.);void main(){vec3 b=texture2D(u1,vv0).rgb;float a=dot(b,f);gl_FragColor=vec4(a,a,a,a);}",j:g,i:["u1"],precision:"lowp"},{id:"s50",name:"_",h:a,j:g,i:["u1","u31"],precision:"lowp"},{id:"s51",name:"_",h:"uniform sampler2D u32,u33,u34,u35;const float f=1.1111;const vec3 g=vec3(1.,1.,1.);varying vec2 vv0;void main(){vec3 a=texture2D(u32,vv0).rgb;float c=texture2D(u33,vv0).r,d=texture2D(u34,vv0).r,h=texture2D(u35,vv0).r,i=a.r*a.r;vec3 b=vec3(c,d,h),j=max(g*f,abs(i-b*b)),k=sqrt(j);gl_FragColor=vec4(a.r,(a-b)/k);}".replace("1.1111",
d.Od.toFixed(4)),j:{u32:0,u33:1,u34:2,u35:3},i:["u32","u33","u34","u35"],precision:"highp"}]);return{process:function(){A.set("s49");e.aa();U.l(d.eb,!1);A.set("s50");for(var v=0;3>v;++v)A.pa("u31",1,0),h[v].u(),q[v].g(0),U.l(!1,!1),A.pa("u31",0,1),l[v].u(),h[v].g(0),U.l(!1,!1);A.set("s51");m.u();e.g(0);l[0].g(1);l[1].g(2);l[2].g(3);U.l(!1,!1);m.g(0)},Nb:function(){return m}}}}}(),W={Ee:function(){return W.Ic()?document.createElement("video"):!1},Ha:function(a,c){a[c]=!0;a.setAttribute(c,"true")},
be:function(){var a=!1,c=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(c)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,
4)))a=!0;return a},Fc:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},se:function(){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return a&&a.length&&2<a.length?[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]:[0,0,0]},md:function(){try{return window.matchMedia("(orientation: portrait)").matches?!0:!1}catch(a){return window.innerHeight>window.innerWidth}},ae:function(){return W.Gc()||W.Fc()},Gc:function(){var a=navigator.userAgent.toLowerCase();
return-1!==a.indexOf("safari")&&-1===a.indexOf("chrome")?!0:!1},dg:function(){return W.be()?W.md()?window.innerHeight/window.innerWidth*45:45:45},Ic:function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?!0:!1},pause:function(a){a.pause()},Tg:function(a){a.play()},release:function(a){a.pause();a.videoStream&&a.videoStream.stop();a.videoStream=null},Hc:function(a){if(!a)return a;var c=null;if(a.video){var d=function(e){return e&&"object"===typeof e?Object.assign({},e):e};c={};
"undefined"!==typeof a.video.width&&(c.width=d(a.video.width));"undefined"!==typeof a.video.height&&(c.height=d(a.video.height));"undefined"!==typeof a.video.facingMode&&(c.facingMode=d(a.video.facingMode))}c={audio:a.audio,video:c};"undefined"!==typeof a.deviceId&&W.yc(c,a.deviceId);return c},yc:function(a,c){c&&(a.video=a.video||{},a.video.deviceId={exact:c},a.video.facingMode&&delete a.video.facingMode)},Jd:function(a){var c=a.video.width;a.video.width=a.video.height;a.video.height=c;return a},
ee:function(a){function c(p){return[480,576,640,648,720,768,800,960,1080,1152,1280,1366,1920].sort(function(y,w){return Math.abs(y-p)-Math.abs(w-p)})}function d(p){var y=W.Hc(a);p=p(y);h.push(p);e(p)}function e(p){if(p.video&&p.video.facingMode&&p.video.facingMode.exact){var y=p.video.facingMode.exact;p=W.Hc(p);delete p.video.facingMode.exact;p.video.facingMode.ideal=y;h.push(p)}}var h=[];if(!a||!a.video)return h;e(a);if(a.video.width&&a.video.height){if(a.video.width.ideal&&a.video.height.ideal){var l=
c(a.video.width.ideal).slice(0,3),m=c(a.video.height.ideal).slice(0,3),q={},g=0;for(q.ka=void 0;g<l.length;q={ka:q.ka},++g){q.ka=l[g];var v={},B=0;for(v.ja=void 0;B<m.length;v={ja:v.ja},++B)if(v.ja=m[B],q.ka!==a.video.width.ideal||v.ja!==a.video.height.ideal){var r=Math.max(q.ka,v.ja)/Math.min(q.ka,v.ja);r<4/3-.1||r>16/9+.1||d(function(p,y){return function(w){w.video.width.ideal=p.ka;w.video.height.ideal=y.ja;return w}}(q,v))}}}d(function(p){return W.Jd(p)})}a.video.width&&a.video.height&&(a.video.width.ideal&&
a.video.height.ideal&&d(function(p){delete p.video.width.ideal;delete p.video.height.ideal;return p}),d(function(p){delete p.video.width;delete p.video.height;return p}));a.video.facingMode&&(d(function(p){delete p.video.facingMode;return p}),a.video.width&&a.video.height&&d(function(p){W.Jd(p);delete p.video.facingMode;return p}));h.push({audio:a.audio,video:!0});return h},pf:function(a){if(W.md()){if(!a||!a.video)return!1;var c=a.video.width,d=a.video.height;if(!c||!d)return!1;if(c.ideal&&d.ideal&&
c.ideal>d.ideal)return a.video.height=c,a.video.width=d,!0}return!1},ib:function(a){a.volume=0;W.Ha(a,"muted");if(W.Gc()){if(1===a.volume){var c=function(){a.volume=0;window.removeEventListener("mousemove",c,!1);window.removeEventListener("touchstart",c,!1)};window.addEventListener("mousemove",c,!1);window.addEventListener("touchstart",c,!1)}setTimeout(function(){a.volume=0;W.Ha(a,"muted")},5)}},Md:function(a,c,d){return null===a?Promise.resolve():new Promise(function(e,h){if(a.srcObject&&a.srcObject.getVideoTracks){var l=
a.srcObject.getVideoTracks();1!==l.length?h("INVALID_TRACKNUMBER"):(l=l[0],c?W.get(a,e,h,d):(l.stop(),e()))}else h("BAD_IMPLEMENTATION")})},$c:function(a,c,d,e){function h(m){l||(l=!0,d(m))}var l=!1;return navigator.mediaDevices.getUserMedia(e).then(function(m){function q(){setTimeout(function(){if(a.currentTime){var v=a.videoWidth,B=a.videoHeight;if(0===v||0===B)h("VIDEO_NULLSIZE");else{v&&(a.style.width=v.toString()+"px");B&&(a.style.height=B.toString()+"px");v={$d:null,kf:null,Qe:null};try{var r=
m.getVideoTracks()[0];r&&(v.Qe=r,v.$d=r.getCapabilities(),v.kf=r.getSettings())}catch(p){}W.ae()?a.parentNode&&null!==a.parentNode?(l||c(a,m,v),setTimeout(function(){a.play()},100)):(document.body.appendChild(a),W.ib(a),l||c(a,m,v),setTimeout(function(){a.style.transform="scale(0.0001,0.0001)";a.style.position="fixed";a.style.bottom="0px";a.style.right="0px";W.ib(a);setTimeout(function(){a.play()},100)},80)):l||c(a,m,v)}}else h("VIDEO_NOTSTARTED")},700)}function g(){a.removeEventListener("loadeddata",
g,!1);var v=a.play();W.ib(a);"undefined"===typeof v?q():v.then(function(){q()}).catch(function(){h("VIDEO_PLAYPROMISEREJECTED")})}"undefined"!==typeof a.srcObject?a.srcObject=m:(a.src=window.URL.createObjectURL(m),a.videoStream=m);W.ib(a);a.addEventListener("loadeddata",g,!1)}).catch(function(m){h(m)})},get:function(a,c,d,e){if(!a)return d&&d("VIDEO_NOTPROVIDED"),!1;if(!W.Ic())return d&&d("MEDIASTREAMAPI_NOTFOUND"),!1;if(e&&e.video){if(W.Fc()){var h=W.se();0!==h[0]&&(12>h[0]||12===h[0]&&2>h[1])&&
W.pf(e)}e.video.width&&e.video.width.ideal&&(a.style.width=e.video.width.ideal+"px");e.video.height&&e.video.height.ideal&&(a.style.height=e.video.height.ideal+"px")}W.Ha(a,"autoplay");W.Ha(a,"playsinline");e&&e.audio?a.volume=0:W.Ha(a,"muted");W.$c(a,c,function(){function l(q){if(0===q.length)d("INVALID_FALLBACKCONSTRAINTS");else{var g=q.shift();W.$c(a,c,function(){l(q)},g)}}var m=W.ee(e);l(m)},e)},De:function(a){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return a(!1,"NOTSUPPORTED"),
!1;navigator.mediaDevices.enumerateDevices().then(function(c){(c=c.filter(function(d){return d.kind&&-1!==d.kind.toLowerCase().indexOf("video")&&d.label&&d.deviceId}))&&c.length&&0<c.length?a(c,!1):a(!1,"NODEVICESFOUND")}).catch(function(){a(!1,"PROMISEREJECTED")})},Gf:function(a,c,d){var e={};e[c]=d;c=[];c.push(e);a.applyConstraints({advanced:c}).catch(function(){})}},pa=function(){function a(y,w,f,n,F,L){if(L===F.length)n();else{switch(F[L]){case "D":y();break;case "S":w().then(function(){p.Kd();
a(y,w,f,n,F,++L)}).catch(n);return;case "R":f()}a(y,w,f,n,F,++L)}}var c={n:5,Zb:1,od:0,Xa:[35,49],Ua:[2,200],k:.7,uf:200,Ve:.05},d=-1,e=null,h=-1,l=-1,m=0,q=-1,g=-1,v=0,B=0,r=c.Ua[1],p={Yc:function(){switch(d){case -1:return-1;case 0:return g+e.od;case 1:return v}},hg:function(y){return Math.pow(Math.min(Math.max(q,0),e.n-1)/(e.n-1),y||1)},A:function(y){e=Object.assign({},c,y);q=g=e.Zb;d=0;p.reset()},Kd:function(y){y=("undefined"===typeof y?Date.now():y)||0;var w=Math.min(Math.max(y-B,e.Ua[0]),e.Ua[1]);
r=w;B=y;var f=-1===h?0:e.k;h=Math.min(Math.max(1E3/w,5),120)*(1-f)+h*f;y-l>e.uf&&5<++m&&(w=e.k,q=q*(1-w)+(h<e.Xa[0]?g-1:h>e.Xa[1]?g+1:g)*w,Math.abs(q-g)>1-e.Ve&&(w=Math.min(Math.max(Math.round(q),0),e.n-1),w!==g&&(q=g=w,h=(e.Xa[1]-e.Xa[0])/2)),l=y)},fc:function(y,w,f,n,F){a(y,w,f,n,F,0)},kc:function(y){v=y;d=1},uc:function(){d=0;p.reset()},reset:function(){r=c.Ua[1];l=h=-1;m=0},ve:function(){return r}};return p}(),Ma=function(){function a(){d(r+v.Yb);p.port.postMessage("DONE")}function c(){f.Oa=0===
v.Na?window.requestAnimationFrame(d):window.requestAnimationFrame(e)}function d(E){w.wa&&null!==B&&(E-=r,E=Math.min(Math.max(E,v.Kc[0]),v.Kc[1]),r+=E,l(),B(r))}function e(E){w.wa&&(f.timeout=window.setTimeout(d.bind(null,E),v.Na))}function h(){B=null;w.wa=!1;l()}function l(){f.Oa&&(window.cancelAnimationFrame(f.Oa),f.Oa=null);f.timeout&&(window.clearTimeout(f.timeout),f.timeout=null)}function m(E){E&&!w.ha?(w.ha=!0,y&&pa.uc(),p.port.postMessage("STOP"),ba.Ld(!0),c()):!E&&w.ha&&(w.ha=!1,y&&pa.kc(1),
ba.Ld(!1),p.port.postMessage("START"))}function q(E){E.target.hidden?F():n()}var g={hd:!0,Kc:[1,200],Yb:20,Na:0},v=null,B=null,r=0,p=null,y=!1,w={na:!1,ha:!0,Wb:!1,Vb:!1,Tb:!1,wa:!1},f={Oa:null,timeout:null},n=m.bind(null,!0),F=m.bind(null,!1),L={A:function(E){v=Object.assign(g,E);Object.assign(w,{ha:!0,na:!0,wa:!1});if(v.hd){E=!1;try{if("undefined"===typeof SharedWorker){var Q=URL.createObjectURL(new Blob(["let handler = null;\n      self.addEventListener('message', function(e){\n        if (handler !== null){\n          clearTimeout(handler);\n          handler = null;\n        }\n        switch (e.data) {\n          case 'START':\n          case 'DONE':\n            handler = setTimeout(function(){\n              self.postMessage('TICK');\n            }, "+
v.Yb.toString()+");\n            break;\n          case 'STOP':\n            break;\n        };\n      }, false);"],{type:"text/javascript"})),G=new Worker(Q);G.addEventListener("message",a);p={yd:G,port:G};w.Wb=!0}else{var J=URL.createObjectURL(new Blob(["let handler = null;\n      onconnect = function(e) {\n        const port = e.ports[0];\n        port.addEventListener('message', function(e) {\n          \n          if (handler !== null){\n            clearTimeout(handler);\n            handler = null;\n          }\n          switch (e.data) {\n            case 'START':\n            case 'DONE':\n              handler = setTimeout(function(){\n                port.postMessage('TICK');\n              }, "+
v.Yb.toString()+");\n              break;\n            case 'STOP':\n              break;\n          };\n          \n        });\n        \n        port.start();\n      } // end onconnect()"],{type:"text/javascript"})),u=new SharedWorker(J);u.port.start();u.port.addEventListener("message",a);p={yd:u,port:u.port};w.Vb=!0}E=!0}catch(t){}E&&("onvisibilitychange"in document?document.addEventListener("visibilitychange",q):(window.addEventListener("blur",F),window.addEventListener("focus",n)),w.Tb=!0)}y=
"undefined"!==typeof pa},m:function(){h();w.Tb&&("onvisibilitychange"in document?document.removeEventListener("visibilitychange",q):(window.removeEventListener("blur",F),window.removeEventListener("focus",n)),w.Tb=!1);w.Vb?(p.port.close(),w.Vb=!1):w.Wb&&(p.yd.terminate(),w.Wb=!1);Object.assign(w,{ha:!0,na:!1,wa:!1});B=null},Jg:function(){return w.ha},update:function(E){Object.assign(v,E)},fc:function(E){w.na||L.A({});l();w.wa=!0;B=E;w.ha&&c()},stop:h};return L}(),tb=function(){var a={td:4,mb:[1.5,
1.5,2],O:[.1,.1,.1],Cd:1,D:-1,M:-1,mf:2,Ue:1,Dd:!0,me:.8},c=null,d=[],e=0,h=[.5,.5,1];return{A:function(l){c=Object.assign({},a,l);d.splice(0);l=c.mb[0]*c.O[0];var m=c.mb[1]*c.O[1],q=1/(1+c.mb[2]*c.O[2]),g=c.Cd*Math.min(c.D,c.M),v=g/c.D;g/=c.M;var B=.5*c.me;B*=B;for(var r=0;r<c.td;++r){var p=Math.pow(q,r),y=v*p,w=g*p;p=y*l;var f=w*m,n=y/2;w/=2;for(var F=1+(1-n-n)/p,L=1+(1-w-w)/f,E=0;E<L;++E)for(var Q=w+E*f,G=Q-.5,J=0;J<F;++J){var u=n+J*p,t=u-.5;t*t+G*G>B||d.push([u,Q,y*c.Ue])}}c.Dd&&d.sort(function(D,
K){var P=D[0]-.5;D=D[1]-.5;var k=K[0]-.5;K=K[1]-.5;return P*P+D*D-(k*k+K*K)})},get:function(){var l=d.length;if(0===l)return h;e>=l&&(e=0);var m=d[Math.floor(e)];e=(e+1/c.mf)%l;return m}}}(),aa={neuralNetworkPath:"NN_DEFAULT.json",ca:0,ub:[2,7],bf:{threshold:1,nScaleLevels:2,scale0Factor:.8,overlapFactors:[2,2,3],scanCenterFirst:!0,nDetectsPerLoop:-1,isCleanGLStateAtEachIteration:!0,animateProcessOrder:"SDR"},rf:50,qd:.5,pd:.4,Re:8,lf:{translationFactorRange:[.0015,
.005],rotationFactorRange:[.003,.02],qualityFactorRange:[.9,.98],alphaRange:[.05,1]},Ka:[.65,1,.262],O:[.092,.092,.3],Qd:.2,Sd:2,Rd:.1,Se:8,sd:1,pe:Za.hb.bind(null,.3,.7),xf:20,Hd:3},oa={facingMode:"user",idealWidth:800,idealHeight:600,minWidth:480,maxWidth:1920,minHeight:480,maxHeight:1920,rotate:0,flipX:!1},fa={$b:-3,Oe:-1,error:-2,ready:1,play:2,pause:3},na=fa.$b,z=null,dc={bb:!1,oc:null,element:null,N:null,G:[0,0],L:[.5,.5],v:[.5,0,0,.5],ob:0,Ga:null,ab:!1},O=null,ec={Fa:null,Ra:null,antialias:!0,
wc:"./",Aa:null,ea:null,ca:aa.ca,xd:aa.ca,cb:!1,ra:!0},Oa=null,ja=null,wa=null,Pa=1,Na={jc:-1,Cb:-1},Z=null,fc={D:0,M:0,G:[0,0],va:null},X={za:null,buffer:null,O:null,Ka:null,Y:aa.sd,Ia:null},Sa=null,qa=null,M={o:1,ma:0,W:null,jd:!1,nd:0,ac:0},hb=[],ib=[],Eb={VERSION:"2.1.5",init:function(a){function c(){na!==fa.error&&2===++e&&(Ja(),xb(),Ia(),O.Fa&&(na=fa.ready,O.Fa(!1,{GL:b,canvasElement:O.ea,videoTexture:z.N.get(),videoTransformMat2:z.v,maxFacesDetected:M.o,videoElement:z.element}),fb()),eb())}
if(na!==fa.$b)return a.callbackReady&&a.callbackReady("ALREADY_INITIALIZED"),!1;na=fa.Oe;z=Object.assign({},dc);O=Object.assign({},ec);Z=Object.assign({},fc);M.W=[0];X.O=aa.O.slice(0);X.Ka=aa.Ka.slice(0);"undefined"!==typeof a.antialias&&(O.antialias=a.antialias);a.callbackReady&&(O.Fa=a.callbackReady);a.callbackTrack&&(O.Ra=a.callbackTrack);a.nExpressions&&(X.Y=a.nExpressions);a.expressionsEasings&&(X.Ia=a.expressionsEasings);"undefined"!==typeof a.animateDelay&&(O.ca=a.animateDelay);"undefined"!==
typeof a.NNCPath&&(O.wc=a.NNCPath);"undefined"!==typeof a.NNC&&(O.Aa=a.NNC);"undefined"!==typeof a.maxFacesDetected&&(M.o=Math.max(1,a.maxFacesDetected));"undefined"!==typeof a.followZRot&&(O.ra=a.followZRot?!0:!1);if(M.o>aa.Re)return Ha("MAXFACES_TOOHIGH"),!1;if(!a.canvasId&&!a.canvas)return Ha("NO_CANVASID"),!1;O.ea=a.canvas?a.canvas:document.getElementById(a.canvasId);if(!O.ea)return Ha("INVALID_CANVASID"),!1;Z.D=O.ea.width;Z.M=O.ea.height;if(!Z.D||!Z.M)return Ha("INVALID_CANVASDIMENSIONS"),!1;
for(var d=0;d<M.o;++d)hb.push(new Float32Array(aa.Se)),ib.push(0);Ma.A({hd:a.isKeepRunningOnWinFocusLost||!1,Na:O.ca});pa.A({Zb:0,n:aa.ub[1]-aa.ub[0]+1,od:aa.ub[0]});ja=Object.create(aa.bf);a.scanSettings&&(Object.assign(ja,a.scanSettings),-1!==ja.nDetectsPerLoop?pa.kc(ja.nDetectsPerLoop):pa.uc());wa=Object.create(aa.lf);a.stabilizationSettings&&Object.assign(wa,a.stabilizationSettings);var e=0;a.videoSettings&&a.videoSettings.videoElement?$a(a.videoSettings.videoElement,c):(a.videoSettings&&Object.assign(oa,
a.videoSettings),zb(a.onWebcamAsk,a.onWebcamGet,function(h){$a(h,c)}));Pb(function(h){if(!Qb())return!1;Oa=new Fb({gb:h.layers,ec:"gpuRawAvg",bc:Sb});A.Ac([{id:"s53",name:"_",qa:"attribute vec2 a0;uniform mat2 u36;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=vec2(.5,.5)+u36*a0;}",Pa:["a0"],Ca:[2],h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",i:["u1","u36"],precision:"lowp"},{id:"s54",name:"_",h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",
qa:"attribute vec2 a0;uniform sampler2D u37;uniform mat2 u36;uniform vec2 u38;uniform float u39,u40,u41;varying vec2 vv0;void main(){vec4 a=texture2D(u37,vec2(.17,u39));vec2 f=a.gb,g=a.a*u38,b=a0;b.x*=u41;float c=cos(u40),d=sin(u40);vec2 h=mat2(c,d,-d,c)*b,i=f+h*.5*g,j=i-.5;vv0=.5+2.*u36*j,gl_Position=vec4(a0,0.,1.);}",Pa:["a0"],Ca:[2],i:"u1 u37 u38 u39 u40 u41 u36".split(" "),precision:"lowp"},{id:"s55",name:"_",h:"uniform sampler2D u42,u37;uniform vec3 u43,u44;uniform float u45,u46,u39,u47,u40,u48;const vec4 e=vec4(.25,.25,.25,.25);void main(){vec4 d=texture2D(u42,vec2(.625,.625)),f=texture2D(u42,vec2(.875,.625)),a=texture2D(u37,vec2(.17,u39));float g=dot(d-f,e);bool h=g>u46;h?a.r=2.:a.r>u45?a.r=0.:a.r>1.9?a.r+=1.:0.,a.r*=u47;if(a.r<.9)a=vec4(1.,u43);else{a.r*=step(1.9,a.r);float i=dot(e,texture2D(u42,vec2(.875,.875))),j=dot(e,texture2D(u42,vec2(.125,.625))),k=dot(e,texture2D(u42,vec2(.375,.625))),b=cos(u40),c=sin(u40);vec2 l=mat2(b,c*u48,-c/u48,b)*vec2(i,j);a.gba+=vec3(l,k)*u44*a.a;}gl_FragColor=a;}",
qa:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",i:"u42 u37 u43 u45 u44 u47 u40 u48 u46 u39".split(" ")},{id:"s56",name:"_",qa:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",h:"uniform sampler2D u42;const vec4 e=vec4(.25,.25,.25,.25);const vec3 f=vec3(.5,.5,.5);void main(){float a=dot(e,texture2D(u42,vec2(.125,.875))),b=dot(e,texture2D(u42,vec2(.375,.875))),c=dot(e,texture2D(u42,vec2(.625,.875))),d=dot(e,texture2D(u42,vec2(.625,.625)));vec3 g=vec3(a,b,c)*.5+f;gl_FragColor=vec4(g,d);}",
i:["u42"]},{id:"s57",name:"_",qa:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",h:"uniform sampler2D u42;const vec4 e=vec4(.25,.25,.25,.25);void main(){float a=dot(e,texture2D(u42,vec2(.375,.375))),b=dot(e,texture2D(u42,vec2(.625,.375))),c=dot(e,texture2D(u42,vec2(.875,.375))),d=dot(e,texture2D(u42,vec2(.125,.125)));gl_FragColor=vec4(a,b,c,d);}",i:["u42"]},{id:"s52",name:"_",h:"uniform sampler2D u37;uniform vec2 u49;uniform float u50;varying vec2 vv0;void main(){float f=step(.5,mod(gl_FragCoord.y+1.5,2.)),c=step(.33,vv0.x);vec4 a=texture2D(u37,vv0+u49);a.a=mix(a.a*u50,a.a,c);vec4 d=floor(255.*a),g=255.*(255.*a-d),b=mix(d,g,f)/255.;b.x=mix(step(a.x,1.5),b.x,c),gl_FragColor=b;}",
i:["u37","u50","u49"]}]);sb();Ob();kb();jb();c()});return!0},destroy:function(){Ma.m();return new Promise(function(a){Eb.toggle_pause(!0,!0).finally(function(){Oa&&Oa.m();Qa.m();Oa=qa=Sa=null;hb.splice(0);ib.splice(0);Z.va=null;X.za=null;z.N=null;na=fa.$b;a()}).catch(function(){})})},toggle_pause:function(a,c){if(!Ya())return Promise.reject("NOT_READY");var d=null;d=z.ab?Promise.resolve():c?W.Md(z.element,!a,z.Ga):Promise.resolve();a?rb():d.then(function(){eb()});return d},update_videoSettings:function(a){rb();
return new Promise(function(c,d){W.Md(z.element,!1,z.Ga).then(function(){Object.assign(oa,a);zb(null,null,function(e){$a(e,function(){Ja();Ia();eb();c()})})}).catch(d)})},toggle_slow:function(a){Ya()&&na===fa.play&&(a&&!O.cb?(O.xd=O.ca,ja.nDetectsPerLoop=1,this.set_animateDelay(aa.zf),O.cb=!0):!a&&O.cb&&(ja.nDetectsPerLoop=-1,this.set_animateDelay(O.xd),O.cb=!1))},set_animateDelay:function(a){O.ca=a;Ma.update({Na:O.ca})},resize:function(){if(!Ya())return!1;var a=O.ea.width,c=O.ea.height;if(!lb()&&
a===Z.D&&c===Z.M)return!1;Z.D=a;Z.M=c;A.R();kb();jb();Ja();Ia();return!0},set_inputTexture:function(a,c,d){z.G[0]=c;z.G[1]=d;z.N=Y.instance({width:c,height:d,Pb:a});z.bb=!0;Ja();fb();Ia()},reset_GLState:function(){fb();Z.va.remove();X.za.remove();sb()},render_video:function(){ua.P();A.set("s53");b.viewport(0,0,Z.D,Z.M);z.N.g(0);U.l(!0,!0)},reset_inputTexture:function(){z.bb=!1;z.N=z.oc;lb();Ja();Ia()},get_videoDevices:function(a){return W.De(a)},set_scanSettings:function(a){Object.assign(ja,a);-1!==
ja.nDetectsPerLoop?pa.kc(ja.nDetectsPerLoop):pa.uc();kb();jb()},set_stabilizationSettings:function(a){Object.assign(wa,a)},set_videoOrientation:function(a,c){Ya()&&(oa.flipX=c,oa.rotate=a,Ja(),Ia())},update_videoElement:function(a,c){$a(a?a:z.element,function(){xb();Ja();Ia();c&&c()})},create_new:function(){return window.JEELIZFACEFILTERGEN()}};return Eb};window.JEELIZFACEFILTER=window.JEELIZFACEFILTERGEN();
if(typeof(module)!=='undefined'){module.exports=window.JEELIZFACEFILTER;}
window.JEELIZFACEFILTER.FAKEDOM=FAKEDOM;